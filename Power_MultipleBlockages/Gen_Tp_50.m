syms x y c_min c_max m_max m_min d1 d2 pause_prob;
syms a b r d d_b m c;
v = 1.5;

if v == 1
    importfile('tp_50');
elseif v == 1.5
    importfile('Tp_50_v_15');
end

t_p = 50;
%Pause time = 10 seconds
if v == 1
    x_block1 = [0.51814     0.66149     0.68608     0.68608           0     0.10849     0.10849           0     0.50667     0.55101     0.55101      0.4706           0      1.6529      1.6529      4.5133      4.5395      4.5395      2.8874      2.8874      2.9315      3.1235      3.1235      1.2336           0      0.2327      0.2327           0           5      4.8645      4.8645           5      4.8153      4.4843      4.4843      3.4907      3.4907      3.5973           5      4.7153      4.7153           5     0.56405     0.56405     0.29007           0    0.053063    0.053063           0      2.1858      2.1858      1.8951      1.7454      1.7454           0      3.0953      3.0953           5      3.8321      3.8321      2.8696      2.8696           0     0.16294     0.16294           0     0.16578     0.96484     0.96484           0     0.88952     0.90386     0.90386     0.89945           0     0.20089     0.20089           0     0.68045      1.0266      1.0266      3.8543      3.8543           0     0.47747     0.47747      3.7953      4.6426      4.6426    0.063004    0.063004           0      2.2639      2.2639           0      1.2133      1.2133           0      2.8932      2.8932           0      1.5957      1.5957      2.2112      2.2112           0      1.9421      1.9421           0     0.93711      1.4394      1.4394      4.1481      4.1481           5      4.7497      3.8708      3.8708           5      2.0918      2.0918     0.16781     0.16781     0.31373      1.9511      1.9511      1.6062     0.72016     0.72016      0.9212     0.95334     0.95334     0.43723           0      2.2182      2.2182      2.4225      2.6116      2.6116      4.1045      4.1045     0.39902     0.39902     0.53469      1.2713      1.2713     0.99116     0.85834     0.85834           5      4.3621      4.3621           5           0     0.13286     0.13286           0     0.13212      2.2154      2.2154           5       2.331       2.331           0     0.54534      1.5235      1.5235      2.2898      4.3061      4.3061      4.4058      4.8244      4.8244      1.0951      1.0951           5       4.012       4.012      4.6971           5      2.6046      2.6046      3.8683      4.8411      4.8411      2.1768      2.1768           0      2.0717      2.1071      2.1071      1.6479      1.6479      3.0726      3.0726      3.8274           5      3.1057      3.1057           0      1.4605      1.4605      2.8349      2.8349      1.8564      1.6327      1.6327      3.2003           5      3.5381      3.5381      3.4632      3.0999      3.0999      2.2456      2.2456           5      3.5486      3.5486      3.8297      4.7239      4.7239           5      2.3496      2.3496      4.2028           5      4.4855      4.4855      2.9006      2.9006           5      1.5146      1.5146           0      1.6488      1.6488           0      2.6462      2.6462           5      1.8173      1.8173           0     0.70629     0.70629       2.302      2.4348      2.4348      4.1311      4.1311      1.6218      1.6218      3.1372      3.6184      3.6184      4.4038      4.4993      4.4993      3.0045      3.0045      1.5457      1.3012      1.3012           0    0.014041    0.014041     0.31382     0.38209     0.38209     0.29572     0.11612     0.11612     0.92362      1.4356      1.4356      2.6232      3.1154      3.1154           0     0.87599     0.87599     0.93936     0.98288     0.98288           5      4.8282      4.8282       1.336       1.336      3.6046      3.6046      1.5028       1.261       1.261      1.2323      1.2323      1.8112      3.5078      3.5078           0      2.1212      2.1212           0     0.44564     0.44564     0.30902     0.13027     0.13027      2.9157      2.9157      3.2544      3.9913      3.9913      3.2507      2.3872      2.3872      3.6333      3.9902      3.9902     0.10397     0.10397           0     0.99365     0.99365      3.3541      3.3541      3.5396      3.9972      3.9972      3.7054      2.8246      2.8246     0.81753     0.81753     0.98222      3.9948      3.9948      4.0936      4.2902      4.2902      1.1725      1.1725           5      4.7333      4.7333      3.1199      3.1199      2.1052     0.16106     0.16106       3.186       3.186       4.728           5      4.3332      4.3332       1.167       1.167           0     0.39063     0.45911     0.45911     0.35835           0     0.83793     0.83793           0      4.3094      4.3094      4.1783      0.5323      0.5323           0     0.74643     0.74643      1.4116      1.5534      1.5534           0      1.8961      1.8961           5      3.8484       3.685       3.685      3.6901      3.8943      3.8943           5      2.7485      2.7485           0       1.407       1.407      1.0576      0.9502      0.9502      1.2355      1.9903      1.9903      2.7571      3.1881      3.1881           5      3.7086      1.3744      1.3744     0.85199     0.18755     0.18755           0      1.0934      2.8017      2.8017           0     0.57048     0.57048      3.4491      3.4661      3.4661      2.3889      2.3889      1.1766           0     0.50122     0.50122           0      1.5808      1.5808      2.1457           5      3.2928      3.2928           5      4.0843      4.0843           0      0.5582      0.5582      2.8715      4.5974      4.5974      4.4608      3.9739      3.9739      3.0955      2.9985      2.9985      4.8488      4.8488           5      2.6825      2.6825      4.8627           5      2.0372      2.0372      1.1853           0      2.5534      2.5534      0.9323      0.9323           0       1.081       1.081           0      1.5702      1.5702       3.296       3.296      4.9845      4.9845      2.9286      2.9286     0.60721     0.60721           0      1.5404      1.5404      1.7026      1.7759      1.7759     0.41354     0.41354           0      1.3523      3.1195      3.1195      4.5559      4.8047      4.8047           5      2.3727      2.3727      3.6131       4.016       4.016           0     0.65645     0.65645      4.2379      4.2379           5      4.8861      4.3975      4.3975     0.41751     0.41751      4.2164      4.2164      4.6305           5      1.9038      1.9038      3.1958      3.6614      3.6614      2.9313      1.8064      1.8064      3.7675      3.9945      3.9945      4.2905           5      3.2485      3.2485           5      2.8521      2.8521           5      1.7536      1.7536     0.57638           0     0.32748     0.32748      1.9802      3.5034      3.5034           5      1.2031      1.2031           0     0.66548      1.3989      1.3989      4.6584      4.6584       1.153       1.153];
    y_block1 = [3.7278           0     0.63948     0.63948      2.7012      3.0272      3.0272      3.3751           5      4.8578      4.8578           5      4.1677      1.2443      1.2443           5      4.9656      4.9656     0.82985     0.82985           0      3.6079      3.6079           5      4.0913      3.9199      3.9199      3.8528        2.41      2.3709      2.3709      3.4835           5      2.2827      2.2827     0.26696     0.26696           0       3.513      4.2261      4.2261      4.0912      1.9901      1.9901           0       2.107      2.4925      2.4925      2.5076      3.1299      3.1299           0       1.612       1.612      1.0467     0.04431     0.04431      2.7336      4.3826      4.3826     0.91004     0.91004     0.55363     0.53339     0.53339       0.269           0      1.2966      1.2966     0.62196           0    0.010032    0.010032           0       2.042      2.4981      2.4981      3.0684           5      4.0173      4.0173      1.6628      1.6628      2.1946      2.2605      2.2605           5      4.3004      4.3004      1.2719      1.2719      1.2977      2.2263      2.2263      3.8264       4.684       4.684      4.0801        2.64        2.64      2.2941      2.1033      2.1033      4.6715      4.6715      3.7513      2.9432      2.9432      4.3305           5      4.6412      4.6412      2.2288      2.2288     0.50617           0      1.7773      1.7773      2.0605        2.79        2.79     0.36087     0.36087           0      4.0494      4.0494           5      2.5581      2.5581           0     0.40907     0.40907           0     0.34654      2.1047      2.1047           0      1.9479      1.9479       4.313       4.313      4.6409      4.6409           5      3.0505      3.0505           0      1.4463      1.4463     0.79547     0.69524     0.69524     0.66031     0.38643     0.37916     0.37916     0.18905           0      2.9808      2.9808       1.915     0.89335     0.89335     0.16937           0     0.30381     0.30381           0      0.7994      0.7994           0      3.3567      3.3567      3.0743      3.0743      1.1919     0.71557     0.71557           0     0.31632       2.818       2.818           5      3.3204      3.3204      1.7493      1.7493     0.85304           0    0.014568    0.014568      3.4548      3.4548     0.86847     0.86847           0      1.3493      3.5289      3.5289      1.8771      1.1004      1.1004      2.9176      2.9176           5      4.5241      4.5241           5      4.4537      4.0098      4.0098           5     0.19769     0.19769       2.022       2.022      3.2101      3.8362      3.8362           5      1.2973      1.2973      1.2686      0.9933      0.9933           0     0.42728     0.70301     0.70301      2.3747      2.3747      2.6338       3.064       3.064       3.169      3.2833      3.2833      3.8434      4.7423      4.7423      4.6852       4.608       4.608      4.1736      4.0047      4.0047           0      0.3332      0.3332      4.9836      4.9836      2.0425      2.0425           0      0.6487      0.6487           5       4.471       4.471       2.419       2.419           5      4.5674      4.5674     0.36957     0.32427     0.32427           5      3.9352      3.9352           5      2.7858      2.7858           0      1.7663      1.7663           5      3.6598      3.6598      2.1035      1.6659      1.6659           0      1.1444      1.1444      2.3072       2.357       2.357      3.3335      3.3335       4.241       4.241           0     0.48797     0.48797      3.7615      3.7615           5      1.3697      1.3697      1.9661      2.3268      2.3268      3.1926      3.3745      3.3745           5      2.8731      2.8731      3.4161      3.4161           5      1.5539      1.5539           0      1.8122      1.8122           5       4.087       4.087      4.0876      4.0876      3.9158      2.2739      2.2739      3.4362      3.4362           5      1.1434      1.1434           0      3.4516      3.4516      4.8227      4.8227           5      1.7572      1.7572           0      3.4982      3.4982      1.3823      1.3823      3.4045      3.5454      3.5454      0.7402      0.7402           0      1.4182      1.4182      1.7412      1.7412           5      4.4252      3.0162      3.0162      1.4196      1.4196      4.1021           5      4.8426      4.8426           5      4.4402      3.1313      3.1313      2.6418      0.1244      0.1244           0      3.4599      3.4599      2.7286      1.7031      1.7031           0     0.36295     0.36295      1.3103      2.4667      2.4667      4.3145           5      4.9027      4.9027           5      1.0941      1.0941      2.3432      4.8866      4.8866       3.818      3.2709      3.2709           0      1.0056      1.0056           0      2.6608      2.6608           5      3.6851      3.6851      4.4528           5      4.0109      4.0109           5      3.7419      3.7419      3.9261           5      3.3223      3.3223      1.5343      1.1702      1.1702           5      4.9774      4.9774      1.1167      1.1167           0      1.0838      1.5455      1.5455      2.3106      4.7238      4.7238           5      3.6044      2.7697      2.7697       2.325      2.0865      2.0865      1.1961      1.0745      1.0745           0     0.80163     0.80163           0      2.8569      2.8569           5      4.7634      4.7634     0.97167     0.97167      1.1914      4.5582      4.5582           5      4.9722      4.3718      4.3718           5       4.126      2.2432      2.2432       4.656       4.656      3.4051      1.9546      1.9546      2.0863      2.2777      2.2777     0.78782     0.78782      4.7647      4.7647      3.3896      3.3896      2.1649      2.1649      2.2305      2.3969      2.3969           5       3.823       3.823      1.1037      1.1037     0.84522           0      1.1045      1.1045           5      4.3251      4.3251      4.2093      2.6509      2.6509           5      4.2371      4.2371      4.8446      4.9439      4.9439      1.7428      1.7428     0.22662           0     0.97198     0.97198      1.9664      1.9664      4.7811      4.7811           5      4.8047      3.1681      3.1681           0      1.1418      1.1418           0       1.759       1.759           0     0.20359     0.20359           0     0.48802      1.6928      1.6928      2.0788      2.5522      2.5522      2.0621      1.3212      1.3212           0     0.64686      1.0144      1.0144           0     0.93489     0.93489      1.0286      1.2664      1.2664     0.45101           0     0.49706     0.49706      4.5027      4.5027  0.00071934  0.00071934];
    time_block1 = [0      3.73054085      4.370497       54.370497       56.543365      56.8869505       106.88695      107.251387      108.953431      109.102405      159.102405      159.265786      160.221917      163.580228      213.580228      218.301108      218.344396      268.344396      272.797904      322.797904      323.628926       327.24191       377.24191      379.589197      381.121338      381.410348      431.410348      431.652538      436.856536      436.997593      486.997593      488.118381      489.646138      492.383513      542.383513       544.63083       594.63083       594.91829      598.701023      599.468819      649.468819      649.783859      654.692254      704.692254      706.701145      708.828061       709.21714       759.21714      759.272312      761.544942      811.544942      814.688293      816.307221      866.307221      868.141888       871.39546       921.39546      924.690925      926.711683      976.711683      980.315193      1030.31519      1033.20681        1033.371        1083.371      1083.68156      1083.99754      1085.52058      1135.52058      1136.69789      1137.78328      1137.80078      1187.80078      1187.81175      1190.04309      1190.54147      1240.54147       1241.1461      1243.19404      1244.23588      1294.23588      1297.91548      1347.91548      1351.80627      1352.28826      1402.28826      1406.59091      1407.68971      1457.68971      1463.18014      1513.18014      1513.24824      1515.69521      1565.69521      1568.46751      1569.95326      1619.95326      1621.30854      1624.54032      1674.54032      1677.45415      1679.06126      1729.06126      1731.70216      1781.70216      1784.09713      1786.20064      1836.20064      1838.58736      1839.73903       1840.3563       1890.3563      1893.98355      1943.98355       1945.9053      1946.46998      1948.45268      1998.45268      1999.61687      2002.61515      2052.61515      2055.71391      2105.71391      2106.10317      2110.47109      2160.47109      2161.48234      2164.08006      2214.08006      2216.64601      2217.05634      2267.05634       2267.7149      2268.27281       2271.1033       2321.1033      2323.21789      2325.17493      2375.17493      2377.97183      2427.97183       2431.6918       2481.6918      2482.07566       2484.1597       2534.1597      2537.22302      2538.67537      2588.67537      2592.86785      2593.51354      2643.51354      2644.15235      2649.15984       2649.2929       2699.2929      2699.52483      2699.75548      2703.39215      2753.39215      2756.37379       2759.2316       2809.2316      2811.67247       2812.2435      2813.26778      2863.26778      2864.09211      2866.26111      2916.26111       2917.0667      2920.44935      2970.44935      2974.18933      3024.18933      3028.52426      3029.62111      3079.62111       3080.6118      3081.04974      3084.51331      3134.51331      3137.03483      3138.97578      3188.97578      3192.06882      3242.06882       3244.4229      3246.66332      3246.70158      3296.70158      3300.17236      3350.17236      3353.12517      3403.12517       3404.2758      3406.06341       3408.9512       3458.9512      3462.46881      3464.12297      3514.12297      3516.40143      3566.40143      3568.70229      3569.22809      3619.22809      3620.86631      3622.74709      3624.27489      3674.27489      3675.26788      3680.08392      3730.08392      3732.09835      3782.09835      3785.09804      3786.67871      3836.67871      3837.87595      3841.68513      3891.68513      3891.96269      3894.62738      3944.62738      3946.73003       3947.6345      3948.21819      3998.21819      4000.52178      4050.52178      4052.63714      4056.14899      4106.14899      4107.66722      4109.31996      4159.31996      4161.06127      4163.85598      4213.85598      4216.21047      4219.39411      4269.39411      4271.26261       4271.9888       4321.9888      4326.29974      4326.65842      4376.65842       4381.6085       4431.6085      4435.47454      4485.47454       4488.0178      4488.82554      4538.82554      4543.24714      4543.78468      4593.78468      4596.32336      4646.32336      4649.28806        4649.785        4699.785      4704.17985      4704.22728      4754.22728      4758.91261      4759.97955      4809.97955      4811.04781      4813.26928      4863.26928      4866.16975      4868.00879      4918.00879      4921.45365      4922.88136      4972.88136      4976.36391      4977.34312      5027.34312      5029.01019       5030.1554       5080.1554      5084.33745      5084.51626      5134.51626      5138.14251      5188.14251      5190.58594      5240.58594      5245.31915      5245.86377      5295.86377      5299.13744      5349.13744       5350.5045      5354.51172      5404.51172      5408.06985      5410.22151      5460.22151      5462.51263      5462.99396      5512.99396       5514.6252      5516.75959      5566.75959      5569.59749      5619.59749      5621.21724       5624.7412       5674.7412      5676.46257      5678.47002      5728.47002      5731.89272      5732.87302      5782.87302      5786.75922      5836.75922      5836.96003      5838.87919      5888.87919      5891.51021      5941.51021        5943.085      5946.96864      5996.96864      5998.14869      6001.71086      6051.71086      6054.14158      6104.14158      6104.38355      6108.80978      6158.80978      6160.56973      6164.07345      6214.07345      6217.84137      6267.84137      6272.17024      6272.47188      6322.47188      6325.70797      6375.70797      6376.96398       6379.3704       6429.3704      6432.41253      6482.41253      6486.01776      6486.65362       6488.2125       6538.2125      6541.75846      6591.75846      6594.68379      6595.66298      6595.83463      6645.83463      6646.02152      6646.68617      6648.24034      6698.24034      6699.21077      6704.20156      6754.20156      6754.38229      6759.40862      6809.40862      6810.31313       6811.5815       6861.5815      6863.40993      6863.79959      6913.79959      6915.61909      6917.84004      6967.84004      6971.45225      6972.79243       6972.9826       7022.9826      7023.08002      7026.99123      7076.99123      7078.65941      7082.05619      7132.05619      7135.00518      7136.51482      7186.51482      7189.80432      7190.81561      7240.81561      7241.86086      7244.62665      7294.62665      7297.08832       7298.4721       7348.4721      7350.43994      7351.84247      7354.37762      7404.37762      7405.49617      7406.91892      7456.91892       7457.1818      7458.71438      7461.10868      7511.10868       7514.4323      7515.10906      7565.10906      7569.90007      7569.92832      7619.92832      7623.93649      7673.93649      7675.58475       7677.1844      7677.86586      7727.86586      7728.78056       7731.6654       7781.6654       7782.2942      7785.47145      7787.37184      7837.37184      7839.13605      7840.08226      7890.08226      7894.26251      7894.83382      7944.83382      7947.38447      7949.28745      7999.28745      8000.10063      8002.99875      8052.99875      8055.31486      8055.57054      8105.57054      8109.78963      8159.78963      8160.05637      8164.14369      8214.14369      8216.36814      8216.50826      8219.53123      8269.53123      8270.58974      8272.06244      8275.23494      8325.23494      8328.14174      8378.14174      8379.70185      8381.51087      8431.51087      8432.59991      8434.18177      8484.18177      8486.46166      8536.46166      8540.78213      8590.78213      8593.25548      8643.25548       8645.8801       8695.8801      8696.49084      8698.04024      8748.04024      8750.64834      8751.82764      8801.82764      8804.86914      8854.86914       8855.3568      8856.95154      8859.03554      8909.03554      8913.18737      8913.90668      8963.90668      8964.13373      8967.18847      9017.18847      9019.84499      9020.70776      9070.70776      9074.76942      9075.43334      9125.43334      9130.23685      9180.23685      9181.93381      9182.18745      9183.27531      9233.27531      9237.37769      9287.37769      9292.10572      9342.10572      9342.57405      9342.99202      9346.49412      9396.49412      9399.91555      9401.14861      9451.14861      9452.50386       9454.5918       9504.5918      9507.22624      9507.53115      9557.53115      9557.89039      9558.75151      9560.87734      9610.87734      9612.67086      9614.87031      9664.87031      9667.07342      9670.40324      9720.40324      9722.17287      9723.03926      9723.53152      9773.53152      9775.47072      9777.25797      9827.25797      9828.75746      9832.56178      9882.56178      9884.01518      9884.81909      9885.70507      9935.70507      9940.86934      9990.86934      9996.57512           10000];
    pause_block1 = zeros(1,length(time_block1));

    x_block2 = [0.99602           0      1.5013      1.5013           0     0.24556      2.5213      2.5213      2.5618      2.8019      2.8019           0      2.0897      2.0897           0     0.49614     0.49614     0.98474      2.2757      2.2757           0      2.2846      2.2846      3.7032      3.7032      1.0453      1.0453      3.9704      3.9704      1.0035      1.0035      1.7726      2.4894      2.4894           5      2.6947      2.6947      2.9545      3.7499      3.7499      4.3415           5      4.4736      4.4736      3.4234      2.8072      2.8072      2.9811      2.9811      1.3561      1.3561           5      4.5187      4.5187      2.8621      2.8621      2.8334      2.8334      4.9224      4.9224           5      4.7747      4.6628      4.6628      1.8319      1.8319           5      2.4288      2.4288           5       4.219       4.219      3.8892      3.8841      3.8841           5      3.7325      3.7325           5       2.336       2.336      1.0474      1.0004      1.0004           0      2.5208      2.5208           0      2.7381      2.7381           5      3.1697      3.1697           0      0.5458      0.5458      1.7729      4.6153      4.6153           5      4.7919      4.2611      4.2611           5      2.6011      2.6011      1.2995           0    0.017409    0.017409     0.92778     0.92778      2.9957      2.9957      1.0736      1.0736      1.5443      2.9063      2.9063           0      1.2117      1.6512      1.6512      1.7142      3.6334      3.6334           0     0.18435     0.18435      1.0997      1.9715      1.9715           0      1.3674      1.3674           0    0.038749      3.0385      3.0385      3.7914      4.9112      4.9112           5     0.65145     0.65145           0      0.7452       1.224       1.224           0      3.1443      3.1443     0.39241     0.39241           0     0.91356      4.0738      4.0738           5      2.8438      2.8438           5      4.2452      4.2452     0.92958     0.92958           0      1.2196      1.2196           5      4.5744      4.5744      4.3527      3.8622      3.8622           5      1.4237      1.3076      1.3076           0      1.4886      1.4886      1.2861           0     0.85292     0.85292      2.7459      2.7459      2.7417      2.7386      2.7386           0     0.93611     0.93611           0      2.5115      2.5115           0     0.29978     0.29978           0      4.8889      4.8889           5       4.523      3.3512      3.3512           5      2.4323      2.1965      2.1965      2.8695      2.8695      1.3069           0     0.22647     0.22647           0    0.059631     0.28401     0.28401           0    0.082377     0.46749     0.46749      1.2869      1.2869      4.0928      4.0928           5      3.9671      3.9671      4.5776           5      3.8489      3.8489     0.82676     0.82676     0.55136     0.49336     0.49336      2.1134      4.1051      4.1051      0.2823           0     0.66473     0.66473     0.63271     0.10967     0.10967     0.64875     0.83107     0.83107      1.9835      4.5646      4.5646      3.1506      3.1506           5      3.2708       3.167       3.167      3.0256      1.6539      1.6539           5      3.5074      3.5074           0       1.635       1.635           0      3.5405      3.5405           5       4.388       4.388      2.0346      2.0346           0      2.1244      2.1244     0.66507     0.50106     0.50106      0.4355           0     0.19644     0.20761     0.20761           0    0.079918    0.079918           0      2.5433      2.5433      4.0236      4.0236       2.625       2.625      3.5266      4.4331      4.4331           5      3.4763      1.3405      1.3405      4.2586      4.2586      3.5966      3.5966      3.5143      3.1394      3.1394           5      4.5352      4.5352           5      4.5782      2.4948      2.4948           5       3.327       3.327      2.4793      2.4793     0.60277     0.60277      1.6682      2.4808      2.4808           0     0.71362     0.71362      4.6888      4.6888      4.1893      3.7075      3.7075       1.581       1.581           0     0.24411     0.24411    0.007557           0     0.60439     0.60439           0       1.831      3.8192      3.8192     0.40681           0     0.34674     0.34674     0.35057     0.36481     0.36481       4.414       4.414           0     0.81773     0.81773      1.5359      2.7616      2.7616      1.8003      1.8003     0.64889      0.1708      0.1708    0.023194           0      0.4524      0.4524     0.69334      0.9996      0.9996           0      3.2009      3.2009           0      1.1428      1.1428           0      3.6638      3.6638      3.9319      4.2998      4.2998      4.6278      4.6278      1.7935     0.95674     0.95674           0       2.334       2.334     0.70042     0.70042      3.4087      3.4087      3.8606      3.9861      3.9861           5      2.3132      2.3132      3.2516      4.7041      4.7041      4.9532           5      4.9493      4.9493      2.2308      2.2308      1.2798      1.2192      1.2192           0     0.32979     0.32979           0      2.8329      2.8329      4.4196           5      3.9094      3.9094      3.0462      2.5309      2.5309      2.8579      2.9084      2.9084      2.8161      1.4175      1.4175      1.7577           5      4.9342      4.9342      1.9826      1.9451      1.9451      3.3839      3.3839           5      3.4936      3.4936      2.9668      2.1842      2.1842      0.9258           0     0.55906     0.55906     0.44485     0.33319     0.33319           0       3.929      4.7178      4.7178           5      2.7867      2.7867       2.804      3.3558      3.3558           5      4.4689      4.0238      4.0238      1.1646      1.1646      3.0786      3.0786           5      4.7634      4.7634      4.5652       2.784       2.784           0      1.9454      1.9454     0.99794     0.99794      1.7436      3.7968      3.7968      2.1834      1.0382      1.0382           5      3.1837      3.1837      3.0688      2.3427      2.3427      3.9962           5      2.6201      2.6201     0.10297     0.10297      2.7614      2.7614      4.2524      4.2524      2.2765           0     0.74751     0.74751     0.24584     0.24584           0      2.3948      2.3948      2.3148      1.7536      1.7536           0      2.2234      2.2234           0      1.9293      1.9293           5      3.0249      3.0249      1.8651      1.1155      1.1155     0.77208     0.41279     0.41279      3.5421      3.5421      2.6669      2.6669           5      4.9004      4.9004];
    y_block2 = [0.42588      0.5073     0.63003     0.63003    0.088564           0     0.82077     0.82077           0      4.8675      4.8675      3.8231      3.0443      3.0443      1.4861      1.1162      1.1162           0      2.9492      2.9492      3.9213      4.8972      4.8972      3.0433      3.0433      1.3644      1.3644      3.0438      3.0438      2.3598      2.3598           0      2.1996      2.1996      1.6406      1.1273      1.1273           0      3.4508      3.4508           5      3.2755      1.8971      1.8971           5      3.1797      3.1797   0.0066361   0.0066361      2.2077      2.2077      2.9553       3.054       3.054     0.74169     0.74169       4.094       4.094      2.0604      2.0604      2.8138           5      3.9143      3.9143     0.24392     0.24392      1.0478      1.7001      1.7001        2.58      2.8473      2.8473           5       4.967       4.967       3.755      2.3784      2.3784      3.1361      4.7288      4.7288           0     0.17241     0.17241     0.26749     0.50709     0.50709      1.7434      3.0864      3.0864      2.6368       2.273       2.273     0.67305     0.39754     0.39754           0     0.92082     0.92082     0.32325           0     0.82463     0.82463      1.5249      3.7982      3.7982           5      3.8001      3.7841      3.7841     0.68575     0.68575      3.6554      3.6554      4.6457      4.6457           5      3.9749      3.9749      4.6984           5      4.8906      4.8906           5      1.6707      1.6707      2.5148      2.5577      2.5577           0      2.4361      2.4361      1.5742     0.97643     0.97643    0.026907           0       2.083       2.083           0       3.098       3.098      3.1205      4.2215      4.2215      2.2524           0       1.447       1.447      1.2985     0.91677     0.91677      3.9907      3.9907       4.294           5      2.5576      2.5576      2.1317      1.1401      1.1401      2.2896       2.692       2.692      2.1487      2.1487      2.6963      3.4147      3.4147      1.7356      1.5466      1.5466           0      3.4226      3.4226      2.5965           0    0.084285    0.084285      2.3544      4.9387      4.9387           5      4.6106      4.3523      4.3523      3.2138      3.2138           5       3.743       3.743      4.1659      4.3104      4.3104       4.217      3.9664      3.9664      2.3984      2.2113      2.2113       2.167      1.4441      1.4441      1.1714           0      2.8774      2.8774      3.7074           5      4.8813      4.8813       2.586       2.586           5      2.9809       2.631       2.631     0.54838           0      2.0634      2.0634     0.46393           0      2.1689      2.1689     0.32977     0.32977      1.8177      1.8177      1.3823     0.88662     0.88662           0     0.61336       2.285       2.285      2.2559      2.2559           5      4.4221      4.4221           5      4.2895      4.2895           5      4.9475       4.824       4.824           5      2.1244      2.1244           0     0.71851     0.71851           0      1.6093      1.6093      4.4152      4.4152      2.1335           0     0.12796     0.12796           0      1.2409      1.2409      2.4627      3.0078      3.0078      3.4262      3.6213      3.6213      3.5376      3.3563      3.3563      1.8931      1.2795      1.2795      1.2219      1.2219     0.81244      0.3849      0.3849           5      4.4813      4.4813           5      1.5542           0    0.088422    0.088422      2.1038      2.8796      2.8796      2.8554       2.085       2.085      3.5815      3.5815      1.7906      1.7906           0      1.8005      1.8005      1.3123           0      1.8395      1.8395      1.3636      1.3636      4.1371      4.1371           5      1.0675      1.0675      1.2255       1.265       1.265     0.60182           0      2.9725      2.9725      3.0244       3.059       3.059      1.0522      1.0522      3.0246      3.0246           0      2.3068      2.3068      1.1641     0.83544     0.83544       1.789       1.789           0      1.7254      1.7254      1.9438      1.9438     0.96916     0.81868     0.81868           0    0.026154      2.1179      2.1179      1.5923           0       1.729       1.729           5        4.61      4.2777      4.2777           5      2.3176      2.3176      2.5782      2.5782     0.94692     0.64472     0.64472           0      1.1003      1.1003      3.2076      3.2076           5      4.2557      4.2557           5      4.8831       2.602       2.602           5      1.9519      1.9519      2.6072      4.7055      4.7055      3.7121      3.3574      3.3574      3.4582      3.7815      3.7815           5       3.328       3.328     0.46682     0.46682           0     0.13781     0.13781     0.23915     0.48637     0.48637      3.5094      3.5094     0.36381     0.36381           5       3.713       3.713      3.6364      3.4334      3.4334           5       2.575       2.575           0     0.48415      1.0081      1.0081     0.95664     0.95664           5      4.7425      4.7425      3.1605      2.7326      2.7326      2.6062      1.5205      1.5205           0     0.55623      1.6013      1.6013           5      2.9711      2.9711           5       4.687       4.687           5     0.25346     0.25346           0      2.4159      2.4649      2.4649           0    0.031314    0.031314       1.645       1.645      2.3695      3.0447      3.0447           5      2.0952      2.0952           0      1.5414      2.4723      2.4723           0       2.417       2.417      2.6189           5       4.522       4.522      4.0254     0.13153     0.13153           0      4.1993      4.1993      1.0253           0     0.85922     0.85922      1.1805      1.1805       2.184       2.184     0.38305     0.16129     0.16129           0      1.4491      1.4491       1.165     0.96649     0.96649      3.9625      3.9625           5      2.1434      2.1434           0      1.5214      1.5214     0.95243      0.6916      0.6916           0      4.3697      4.3697           5      4.6174      3.7103      3.7103      3.2315      3.2315      2.4259      2.4259      3.9826      3.9826           5      3.8277      3.4428      3.4428     0.52221     0.52221     0.50875     0.37761     0.37761           0      2.6477      2.6477      2.5529      2.4327      2.4327      1.3682     0.44461     0.44461      2.3375       3.555       3.555           5      4.0661      4.0661           5      4.0231      4.0231      4.4178      4.4178      1.1106      1.1106      3.3791       3.476       3.476];
    time_block2 = [0     0.999343619      2.5056499      52.5056499      54.1016072       54.362649      56.781873      106.781873      107.603645      112.477029      162.477029       165.46721      167.697347      217.697347         220.304       220.92287       270.92287      272.141326       275.36074       325.36074      327.835398      330.319702      380.319702      382.654087      432.654087      435.797846      485.797846      489.170817      539.170817      542.215579      592.215579      594.697563      597.011018      647.011018       649.58305       651.94477       701.94477      703.101649      706.642878      756.642878      758.301231      760.147142      761.622677      811.622677      814.898499      816.820288      866.820288      869.998069      919.998069      922.733985      972.733985      976.453754      976.945064      1026.94506      1029.78962      1079.78962      1083.14202      1133.14202      1136.05733      1186.05733      1186.81475      1189.01249      1190.10395      1240.10395      1244.73923      1294.73923      1298.00772      1300.66035      1350.66035      1353.37789       1354.2034       1404.2034       1406.3812      1406.41462      1456.41462      1458.06203      1459.93334      1509.93334      1511.41011      1514.51394      1564.51394      1569.41519      1569.59388      1619.59388       1620.5988      1623.13098      1673.13098      1675.93867      1678.98841      1728.98841      1731.29451      1733.16062      1783.16062      1786.71123      1787.32262      1837.32262      1838.61254      1841.60035      1891.60035      1892.31104      1892.69547       1893.6762       1943.6762      1944.69423      1947.99912      1997.99912      1999.77076      2001.53947      2001.56316      2051.56316      2054.79246      2104.79246      2108.41122      2158.41122      2160.57343      2210.57343       2211.1626       2212.8672       2262.8672      2265.86215      2267.11085       2267.5637       2317.5637      2317.68997      2321.53287      2371.53287      2375.26308      2375.45234      2425.45234      2428.16885      2430.75622      2480.75622       2482.9079      2484.40024      2534.40024      2536.06498      2536.11216       2539.7642       2589.7642      2591.97911      2595.27327      2645.27327       2645.3649      2649.85066      2699.85066      2701.92466      2704.29716      2705.82134      2755.82134      2757.05428      2760.22169      2810.22169      2814.34746      2864.34746      2864.84341        2865.998      2869.99206      2919.99206      2921.01148      2923.38477      2973.38477      2975.82827      2976.68362      3026.68362      3030.04348      3080.04348      3081.12235      3082.53777      3132.53777       3136.6743         3137.14         3187.14      3188.70243         3192.16         3242.16       3243.5661      3247.98554        3248.129        3298.129      3300.74881      3303.73117      3353.73117      3353.94271      3355.28652      3356.17768      3406.17768      3408.38669      3458.38669      3460.17286      3461.42985      3511.42985      3514.20094      3515.14815      3565.14815      3566.08891       3568.6129       3618.6129       3621.5737       3621.9271       3671.9271      3672.23013      3677.17221      3727.17221      3727.46671       3728.7315      3731.83835      3781.83835      3783.68425      3786.55897      3786.82292      3836.82292      3839.21486      3889.21486      3892.09044      3894.49563       3894.9124       3944.9124      3947.00732      3947.55893      3949.63449      3999.63449      4001.25898      4001.73017      4003.93298      4053.93298      4055.94641      4105.94641      4109.12239      4159.12239      4160.12867      4161.27436      4211.27436      4212.35086      4213.09557      4215.12526      4265.12526       4268.1475       4318.1475      4320.90535      4321.48613      4371.48613      4373.20611      4375.32081      4425.32081       4429.2091      4429.49623      4430.17234      4480.17234      4480.35124      4483.27405      4533.27405      4535.46575      4536.20703      4586.20703      4587.56506      4590.60676      4640.60676      4643.74873      4693.74873      4696.68577      4699.43204      4699.59675      4749.59675      4749.78749      4751.63719      4801.63719      4805.19942       4806.7884       4856.7884      4860.32069      4861.96733      4911.96733      4913.60451      4917.14961      4967.14961       4969.2163      4970.08295      5020.08295      5022.43705      5072.43705      5074.51241      5076.67938      5126.67938      5131.51971      5132.06372      5182.06372      5182.58655      5186.05971      5187.62632      5187.71545      5237.71545      5239.74152      5240.52143      5290.52143      5290.60494      5293.26235      5343.26235      5345.36731      5395.36731      5397.63961      5447.63961      5449.64435      5451.66019      5501.66019      5502.40834      5504.41921      5507.23794      5557.23794      5560.19451      5610.19451      5613.04588      5663.04588      5663.91272      5667.86302      5717.86302      5719.73032       5720.1968       5770.1968      5771.00663      5771.74155      5775.37144      5825.37144      5827.87716      5829.55047      5879.55047      5881.72896      5931.72896      5934.45138      5984.45138      5987.65812      5990.10384      6040.10384      6042.83513      6043.62081      6093.62081      6097.70873      6147.70873      6149.56617      6151.35758      6201.35758      6203.49522      6253.49522      6255.35255      6255.63931      6305.63931      6306.49148       6306.5187      6308.69599      6358.69599      6359.49694      6361.92345      6364.55823      6414.55823      6419.28518       6419.8487      6420.32902      6470.32902      6471.05137      6473.73382      6523.73382      6527.79138      6577.79138      6582.49715      6583.36893      6633.36893      6634.33407      6635.98119      6685.98119      6688.29741      6738.29741      6740.42778      6741.31236      6791.31236      6792.07111      6792.19034      6794.51585      6844.51585      6846.92595      6849.98941      6899.98941      6901.18465      6905.01206      6955.01206      6958.36362      6959.56015      7009.56015      7010.70735      7014.38541      7064.38541      7065.63309      7067.34509      7117.34509        7120.225        7170.225      7173.09752      7173.94554      7223.94554      7224.90763      7227.25466      7277.25466      7280.69088      7330.69088      7334.84174      7384.84174       7389.4999      7390.79296      7440.79296      7441.80977      7444.50426      7494.50426      7496.33043      7499.15715      7549.15715      7551.74419       7552.2306      7552.75704      7602.75704      7605.47607      7655.47607      7659.62975      7659.89428      7709.89428      7711.89156      7712.43181      7762.43181      7762.78499      7765.81886      7815.81886      7818.01645      7818.82036      7820.33086      7870.33086      7873.83742      7875.93076      7925.93076      7927.98586      7928.30292      7978.30292      7978.62925      7983.57756      8033.57756      8034.00176      8038.04518       8038.1272       8088.1272      8091.97269      8092.02154      8142.02154      8144.18352      8194.18352      8195.95453      8197.60534      8247.60534      8249.63033      8252.63869      8302.63869      8305.08277      8306.88087      8307.96668      8357.96668       8360.4416       8362.8612       8412.8612       8413.2508      8417.84495       8418.7673       8468.7673      8469.33844      8473.81739      8523.81739      8523.95004      8528.18544      8578.18544      8581.76003      8582.91471      8583.88237      8633.88237      8636.75956      8686.75956      8688.92061      8738.92061       8741.5541      8741.87838      8791.87838      8792.13394      8794.43017      8844.43017       8847.2286      8849.18415      8899.18415      8902.32641      8952.32641      8953.60409      8957.12194      9007.12194      9009.80474      9011.70895      9061.70895      9065.71139      9067.54627      9117.54627      9118.24735      9122.67701      9172.67701      9174.44665      9175.52084       9178.0678       9228.0678      9230.63002      9280.63002      9283.40787      9333.40787      9335.56335      9385.56335      9387.78577      9390.34641      9391.18721      9441.18721      9444.15056      9494.15056      9494.39677      9496.79519      9546.79519      9547.18119      9549.88774      9599.88774      9601.64386       9603.8705       9653.8705      9656.33556      9658.47457      9708.47457      9712.08182      9714.40202      9764.40202      9766.25487      9767.45235      9817.45235      9818.44735      9819.48827      9869.48827      9872.64241      9922.64241      9926.06342      9976.06342      9979.31755      9979.45644           10000];
    pause_block2 = zeros(1, length(time_block2));

elseif v == 1.5
    x_block1 = [4.422           5      4.8643      4.1614      4.1614           5      3.9956      2.2639      2.2639           5      3.8489      1.9261      1.9261           0     0.54821      4.6914      4.6914      1.1568      1.1568           0      3.6406      3.6406      1.1113           0     0.66309     0.66309           5      3.0455      3.0455      1.2243     0.43679     0.43679      1.2123      4.4966      4.4966      4.6132        4.72        4.72      3.3117      1.8991      1.8991           0      3.5422      3.5422           5      1.4054      1.4054           5      2.1777      2.1777      2.7474           5      3.4948      3.4948           0      1.3724      3.2475      3.2475      4.2936           5      2.2605      2.2605           0           5       4.294       4.294      3.8863      3.0952      3.0952           0      3.0984      3.0984      1.1712     0.32689     0.32689           0       1.953      2.6773      2.6773           0      3.6763      3.6763           5           0      2.5935      2.5935      2.5637      2.1579      2.0666      2.0666           0      1.6633      1.6633           5      1.7149      1.7149      2.2394           5      3.5301      3.5301           0     0.60446     0.60446      2.2383           5      2.8177      2.8177           0      1.0812      1.0812           0    0.054921      2.9828      2.9828           0      2.4362      3.9071      3.9071      3.6101      2.7855      2.7855           5      4.0988      4.0988           5      1.7057      1.7057      1.6331           0     0.88081     0.88081     0.86887     0.47806     0.19747     0.19747      4.3322           5      3.2995      3.2995      2.3115           0     0.74591     0.74591           0      3.2033      4.8748      4.8748           5           0      2.4672      2.4672      1.9591           0     0.42055     0.66948     0.66948        2.33           5      4.1579      4.1579      3.9901      3.9664      3.9664      4.5778           5      4.9563      4.9563           5      4.3298      3.8248      3.8248      4.0977           5      4.8624      4.8624      4.8721      4.9455      4.9572      4.9572      3.7396     0.70214     0.70214      1.8001      2.6151      2.6151           0       1.797       1.797      1.3778           0       1.672      1.8631      1.8631      3.8342       4.381       4.381           5      3.3087      1.0498      1.0498       2.921      4.9449      4.9449      1.8793     0.33723     0.33723      4.1367      4.1367           0      2.5352      2.5352           5      2.3084      2.3084     0.74679    0.057483    0.057483    0.081545      0.1568      0.1568           0     0.61485      2.9284      2.9284      3.1326      4.7699           5      4.4368      4.4368           5      2.0537           0     0.90845     0.90845           0       4.199      4.7253      4.7253     0.82576           0     0.31318     0.31318           0      4.0476           5      4.5199      4.5199           5      4.5105      3.3047      3.3047           5      2.7318      1.2668      1.2668           0      3.9228      4.8987      4.8987      3.0831       2.012       2.012      1.2603     0.15316     0.15316           0       2.085      2.9508      2.9508           0      3.2275      3.2275      2.0249       1.922       1.922      4.3993           5      4.1732      4.1732           5      1.4201     0.23626     0.23626           0    0.063252      2.1686      3.2452      3.2452           5       2.017           0     0.18983     0.18983           0      2.1059      4.4146      4.4146      4.4349      4.4441      4.4441      3.0045      1.8787      1.8787           0           5      3.9754      3.9754      3.4637      3.3045      3.3045           0      4.2323      4.2323     0.72982     0.72982           5      1.1343      1.1343     0.32099     0.15933     0.15933     0.46143      2.9044      2.9044      3.4571      4.8406      4.8406     0.84264     0.84264           0     0.77098      2.9271      2.9271           5     0.98128           0     0.50206     0.50206      1.2309           5      4.3199      4.3199           5      3.9371      3.3423      3.3423           0      2.4287      2.4287       2.126      1.6077      1.6077      3.0962           5      3.9122      3.9122     0.77583     0.77583           0     0.90811      4.2449      4.2449           5      1.5137      1.5137           0       4.052      4.4207      4.4207      4.1839      0.2379      0.2379      1.0309      3.4101      3.4101      2.9912      2.9912           0       1.072       1.072           0      1.2326      4.3612      4.3612      4.7006           5      4.4696      4.4696      1.0917           0      1.5218      1.5218      3.8229           5      4.1984      4.1984      4.3523      4.6831      4.6831      4.5345      4.4897      4.4897           5      3.9968      1.2766      1.2766           5      4.3666      3.0865      3.0865           0      2.2182      2.2182      2.3036       2.405       2.405      4.1014           5      3.4939      3.4939      3.2483      2.8872      2.8872      1.3313           0     0.85127     0.85127           0      1.4607      1.5844      1.5844      1.0916     0.85809     0.85809     0.76835     0.60429     0.56457     0.56457     0.42169     0.42169           5        2.51      2.3506      2.3506      2.4032      4.3294      4.3294           5      3.3623      2.3787      2.3787      3.6369           5      2.4371      2.4371       2.438      2.5676      2.6387      2.6387      2.9038      3.2782      3.2782       3.194      2.9615      2.8901      2.8901           0     0.24207      1.3507      1.3507           0      1.1891      2.6254      2.6254      2.0397      1.8824      1.8824      3.8118           5      4.6057      4.6057           5      3.0595      3.0595      2.2224           0     0.38284     0.44292     0.44292     0.49058      2.1012      2.1012      1.1638           0      1.4043      1.4043      2.9245      4.9811      4.9811       3.637       2.922       2.922           5      2.4379      2.4379      3.2065           5      1.7732      1.7732      2.4748      3.1076      3.1076           5       3.377       3.377           5           0      1.0805      1.0805      3.0284           5      4.6193      4.6193           5      4.8662      2.2883      2.2883      2.5394      3.5953      3.5953     0.76901           0     0.78212     0.78212           0      3.4423           5      4.9706      4.9706      3.5368      2.3351      2.3351     0.37501           0      3.3246      3.3246           5      4.3043      4.3043           5       2.533           0      1.2047      1.2047      1.3981      2.2577      2.2577      1.9308      1.6241      1.6241           0      3.7939      4.6992      4.6992      4.5282      4.4887      4.4887      3.7316     0.16578           0     0.66227     0.66227      0.5178           0      0.1043       0.175       0.175           0           5      4.6248      4.6248           5           0     0.11196     0.11196           0      4.0805           5      2.3173      2.3173           5       3.754      0.2936      0.2936           0    0.057702      1.5758      1.5758     0.70001           0        3.29        3.29      4.3922           5      3.0627      3.0627      3.4838      3.9107      3.9107           5      3.0815      1.8658      1.8658           5     0.42218     0.36319     0.36319     0.32459           0           5      3.4167      3.4167      2.8376      1.4779      1.4779           0      4.3873      4.3873       3.806      2.7689       2.664       2.664      2.7306      3.3888      3.6701      3.6701           5      1.8382           0     0.83365     0.83365           5      1.9067      1.9067           0      3.8926      3.8926           0     0.65043     0.93343     0.93343     0.31244           0      4.8974      4.8974           5      3.4604      1.7513      1.7513           0           5      3.1265      3.1265      2.6212           0     0.39344     0.39344];
    y_block1 = [3.6043      4.7347           5      3.6252      3.6252      1.9757           0      3.4064      3.4064      4.5281           5      4.2118      4.2118      4.8254           5      3.6801      3.6801      2.2686      2.2686      2.1836      1.9159      1.9159           5      3.6449      2.8363      2.8363      3.2589      3.4493      3.4493           5      4.3294      4.3294           5      2.1599      2.1599           0      1.9788      1.9788           5      1.9696      1.9696      2.3809      3.1481      3.1481      3.3043      3.6895      3.6895      1.8992      0.4935      0.4935           0      1.9512       3.255       3.255       4.508           5      4.3278      4.3278           5       4.546      2.7855      2.7855      2.5626      2.0695      1.9999      1.9999           0      3.8804      3.8804      2.7446      1.6075      1.6075           5      3.5137      3.5137      3.7268           5      4.5279      4.5279      4.4508       4.345       4.345      4.3877       4.549      4.6327      4.6327           5           0       1.125       1.125       1.965       2.641       2.641      1.6018     0.57864     0.57864           0      3.0458      4.6675      4.6675      1.6481      1.1311      1.1311           0      1.9118      3.4225      3.4225      1.7124      1.0563      1.0563    0.051062           0      2.7222      2.7222      1.2238           0     0.73892     0.73892           0      2.0519      2.0519      3.6373      4.2825      4.2825      3.3926     0.13994     0.13994           0      3.1489      4.8472      4.8472           5           0      3.5899      3.5899           5      4.7723      4.1923      4.1923           5      3.1103      2.5006      2.5006      2.9727           5      3.9421      3.9421      3.8947      2.0017      1.0676      1.0676           0      4.1164           5       4.477       4.477           5       4.159      3.8937      3.8937           0     0.55117     0.55117           5      1.9282      1.6102      1.6102      1.5117           0      1.1389      1.1389           0      3.7659      4.3403      4.3403           5           0     0.79592     0.79592           0      1.9857      1.9857           5      2.7628      2.7628      3.6815      4.3128      4.3128           5      2.7412           0      0.3133      0.3133           5      3.6998      3.6998      4.0482           5      3.7288      3.7288           5      3.6251      3.6251           5      4.3084      4.3084     0.49562     0.49562     0.20981    0.034643    0.034643      1.1824      2.4358      2.4358           5      3.8681      3.8681           5      1.4597      1.4597      1.1631           0      4.3765      4.3765           5           0     0.70259      2.4225      2.4225      2.0338           0      1.4176      2.0447      2.0447       1.681           0     0.21072     0.21072           5      3.9858      3.6012      3.6012      3.3426           0     0.78648       1.183       1.183      3.0731           5      0.2531      0.2531      2.2835           5      3.2454      3.2454      3.6737           5        4.67        4.67           0       2.755       2.755           0      4.0572      4.0572      3.7796           0      1.5694      1.5694     0.94976     0.27206     0.27206           5      4.5955      4.5955           0      1.1143      2.6479      2.6479      2.1511           0     0.71132     0.71132     0.15022           0           5      2.4431      2.4431      1.5382           0      1.0401       1.138       1.138      1.0439           0      1.1444      1.1444           5      3.2614      3.2614           0      2.5505      2.5505      3.0027      4.2063       4.453       4.453           0      1.3855      1.3855      1.4794      1.5996      1.5996     0.42622     0.42622      1.5384      2.5452      2.5452           5      4.5121      4.5121           5      1.0544      1.0544           0      2.6394      2.6394        3.43        3.43      4.2499           5      2.9022      2.9022      1.9146           0      0.4675     0.70669     0.70669           0      3.6546       4.314       4.314      2.6307           0      1.4723      1.4723      1.2761      1.1335      1.1335           0      1.9411      1.9411           0      2.4827      3.9014      3.9014      2.8903      2.8903      3.8623           5     0.81955     0.81955     0.99726      1.8178      1.8178      2.6832           5      4.7892      4.7892           5      1.4876      1.4876           0      4.4637      4.4637     0.72487     0.72487       3.393      4.3492      4.3492      4.6519           5      4.1165      4.1165           5      4.2205        2.84        2.84           5      4.3019      3.3288      3.3288           0      1.7029      2.8625      2.8625           5     0.40535     0.40535           5      3.6123      3.6123      4.0802           5       2.506       2.506      4.6374           5      4.2672      4.2672      3.5491       3.033       3.033           0      3.6001      3.6001           5      4.2585      3.0157      3.0157           5      2.0826      2.0826           5      2.5037     0.90756     0.90756      2.4144           5      4.7811      4.7811           0       2.265       2.265           5           0      1.2104      1.2104      4.5159      4.5159      1.5908           0     0.10184     0.10184           0      3.7335      3.7335      2.6488           0      1.5908      1.5908           0      1.7234      4.9638      4.9638           5           0       2.741       2.741           5      1.8099      1.8099           0           5      3.4653      3.4653      4.8814           5      4.4568      4.4568      2.0866           0      2.5202      2.5202           0     0.67705     0.67705           5      2.3378      1.4544      1.4544      1.7818      3.3935      3.3935           5     0.73474           0      0.1153      0.1153           0      3.8962      3.8962           5      3.6297      1.9761      1.9761           5     0.90907     0.90907           5      2.8239      2.8239      1.8472     0.64293     0.64293           0      1.5003      4.1997      4.1997           0       3.788       3.788      3.7939       3.799       3.799      3.1444       1.128     0.69226     0.69226           0     0.70063     0.83594     0.83594     0.21736           0      4.1884      4.1884           5      1.5879      1.5879           5      4.0716      3.1274      3.1274      3.4741           5      4.3095      4.2965      4.2965           0      3.6012      3.6012           5      4.7324      2.3597      2.3597      3.8956      4.5334      4.5334       4.636           5      4.6263      4.4485      4.4485           5      2.5491      2.5491           0      2.3916      2.3916      1.6747           0     0.39962     0.39962           5      3.9383      3.9383           5           0     0.23246      1.1611      1.1611           0      4.1617           5      4.4318      4.4318      4.3922      3.2605      3.1756      3.1756       3.056       1.462      1.4263      1.4263      1.3882           0     0.31284      1.2255      1.2255     0.38868           0      1.0795      1.0795     0.17731           0      4.6648      4.6648           5      4.7321      3.4727      3.4727           5      4.1579      1.4734      1.4734           0      1.4939      1.4939      2.7637           5      3.5829      3.5829      4.1588           5      4.9892      4.9892           5      4.9089       3.505      3.0604      3.0604           5     0.44614     0.44614     0.88749      2.1977      2.1977           5           0     0.50596     0.50596           0           5      2.8628      2.8628      3.4955           5      4.1254      3.7287      3.7287      2.1271     0.93795     0.93795      2.2573      4.9507      4.9507      0.7088           0      0.3084      0.3084           0     0.15516      2.5873      2.5873      2.7381           5      2.4892      2.4892      2.0812     0.91646     0.48003     0.48003           0      2.4899      2.8636      2.8636];
    time_block1 = [0       0.8464003      1.04505225       2.0744511      52.0744511      53.3080854      54.7856238      57.333178      107.333178      109.304603      110.134007      111.519393      161.519393      162.867037      163.250606      166.149515      216.149515      218.686869      268.686869      269.460131      271.893776      321.893776      324.552858      325.721224      326.418341      376.418341      379.323304      380.632507      430.632507      432.227085      432.916655      482.916655      483.600122      486.494794      536.494794      537.936837      539.257932      589.257932      591.480166      593.709171      643.709171      645.004589      647.420814      697.420814      698.398242      700.808395      750.808395      753.485611      755.587608      805.587608      806.090098       808.07689      809.404458      859.404458      861.879541      862.851529      864.179468      914.179468      915.008422      915.568244      917.739191      967.739191      969.253485      972.602988      973.075947      1023.07595      1024.43665      1027.07679      1077.07679      1079.27484      1081.47513      1131.47513      1134.07622      1135.21584      1185.21584      1185.47599      1187.03027      1187.60663      1237.60663      1239.39222      1241.84411      1291.84411      1292.72703       1296.0621      1297.79198      1347.79198      1348.03767      1351.38196      1352.13442      1402.13442      1403.62163      1404.81861      1454.81861      1457.14845      1459.44227      1509.44227      1509.96291      1512.70336      1514.16253      1564.16253      1567.25936      1567.78964      1617.78964      1619.11444      1621.35366      1623.12309      1673.12309      1675.32046      1676.16361      1726.16361       1727.1478       1727.1978      1729.86305      1779.86305      1782.08841      1783.90591      1785.00333      1835.00333      1835.53424      1837.00853      1887.00853      1888.82422      1889.56312      1939.56312      1940.40746      1943.49381      1993.49381       1993.5989      1995.96369      1997.23912      2047.23912       2047.3413       2050.6848      2053.08535      2103.08535      2105.99774      2106.46811      2107.66587      2157.66587      2158.51661      2160.50704      2161.14933      2211.14933      2211.73783       2214.2651      2215.58387      2265.58387      2265.67314      2269.23737      2270.99612      2320.99612      2321.78435      2324.82354      2325.47595      2325.86211      2375.86211      2377.02271      2378.88896      2379.47754      2429.47754      2432.07576      2432.44355      2482.44355      2485.43732      2487.50443       2487.7184       2537.7184      2537.79029      2538.89267       2539.7232       2589.7232      2590.50393       2593.0856      2593.47935      2643.47935       2643.9192       2647.2529      2647.78357      2697.78357      2698.75331      2701.17261      2751.17261      2753.31134      2754.89866      2804.89866      2806.74648      2808.01623      2858.01623      2858.55284      2860.31677      2862.45732      2862.70197      2912.70197      2916.09153      2917.03186      2967.03186      2967.50537      2968.79921      2970.52725      3020.52725      3022.03538      3023.66654      3073.66654       3075.9064      3077.03312      3127.03312      3130.62155      3180.62155      3183.38592      3185.08006      3235.08006       3236.8927      3238.87214      3288.87214      3290.87368       3291.7572       3341.7572      3342.51199       3344.8727       3394.8727      3395.09638      3395.97346      3399.27375      3449.27375       3449.7111      3453.21861      3453.71148      3454.91802      3504.91802      3505.37427      3507.76098      3509.42462      3510.16053      3560.16053       3560.8129       3563.8282      3564.20617      3614.20617      3618.32354      3619.19542       3619.5261       3669.5261      3669.79688      3673.29646      3674.11989      3674.53501      3724.53501       3725.8351      3727.16051      3730.42562      3780.42562        3782.189       3784.5483      3786.07221      3836.07221      3836.96367      3839.72431      3840.41108      3890.41108      3893.75146      3895.72201      3945.72201      3947.62579      3950.42949      4000.42949      4000.64088      4003.51858      4004.71346      4054.71346      4056.72356      4058.92216      4108.92216      4112.17449      4112.45274      4162.45274      4165.93322      4166.77712      4167.93865      4217.93865      4218.58167      4221.36601      4222.28673      4272.28673       4272.6926      4272.80127      4276.41804      4278.26759      4328.26759      4329.58383      4331.82134      4333.33425      4333.47664      4383.47664      4383.61788       4385.1848      4386.90267      4436.90267      4439.47309      4440.63214      4490.63214      4493.00883      4494.86742      4544.86742      4546.15569      4549.58424      4550.28683      4600.28683      4603.27501      4604.20477      4654.20477      4656.40865      4659.23129      4709.23129       4711.6938       4761.6938      4764.63555      4767.29863      4817.29863      4819.02267      4819.36533      4869.36533       4869.7479      4872.84169      4922.84169      4923.63534      4925.62198      4975.62198      4978.33891      5028.33891      5029.12268      5029.83981      5031.84535      5081.84535      5083.37608      5086.34374      5087.06838      5087.43913      5137.43913      5138.11592       5141.6159      5142.24739      5192.24739      5193.45768      5195.34922      5196.40782      5246.40782      5248.63987      5250.26177      5300.26177       5301.0439      5302.38331      5352.38331      5354.01406      5356.09984      5357.29163      5407.29163      5409.48848      5459.48848      5460.31759      5461.28804      5464.85396      5514.85396      5515.37111       5517.7588       5567.7588      5568.92124      5572.03296      5572.31609      5622.31609      5622.52746      5626.04929      5676.04929      5677.17315      5680.54529      5730.54529      5733.05344      5783.05344       5785.7256      5786.68327      5836.68327       5837.4259      5838.27979      5840.44705      5890.44705        5891.078      5891.63467      5892.62061      5942.62061      5945.29363      5946.15748      5947.36173      5997.36173      6000.05953      6001.43964      6002.37943      6052.37943      6053.80809      6056.87912      6106.87912      6109.94382      6110.86943      6160.86943      6161.33102      6162.23837      6164.69866      6214.69866      6217.55885      6218.04538      6219.02874      6269.02874      6271.14137      6272.65966      6322.65966      6324.68246       6327.0835       6377.0835      6378.54979      6379.32646      6380.62826      6430.62826      6431.96122      6433.92101      6483.92101      6486.12527      6488.01134      6489.21732      6539.21732      6540.37111      6542.35088      6542.51852      6592.51852      6595.72278      6597.24078      6647.24078      6649.06509      6652.40022       6653.2076       6703.2076      6705.41334      6755.41334      6759.03532      6761.00517      6761.13128      6811.13128      6811.20768      6814.00841      6864.00841      6864.85857      6866.93473      6868.18161      6918.18161      6919.53378      6920.99863      6923.75294      6973.75294      6973.77707      6977.11152      6978.93944      7028.93944       7030.4558      7032.59716      7082.59716      7083.80504      7087.14197      7088.16623      7138.16623      7140.31181      7140.49152      7141.31456      7191.31456      7193.13322      7194.73436      7196.66819      7246.66819      7248.39311       7248.8565       7298.8565      7302.01248      7303.95604      7304.60098      7354.60098      7354.94267      7356.62432      7406.62432      7407.83201      7411.03836      7411.59069      7411.67737      7461.67737      7461.76054      7464.57122      7514.57122      7515.53662      7516.73517      7518.18143      7568.18143      7570.43774      7573.49027      7623.49027      7626.36099      7627.88802      7677.88802      7679.41874      7681.30605      7731.30605      7731.97406      7733.53292      7736.33758      7786.33758      7789.17616      7791.73647      7841.73647      7842.99807      7844.08008      7894.08008      7895.24676      7898.84096      7899.61764      7949.61764      7950.99586      7952.39076      7952.66013      8002.66013      8003.14438      8003.31453      8006.59331      8056.59331       8057.1597      8059.54083      8109.54083      8112.49454      8113.29823      8114.11562      8164.11562      8164.68597      8167.19623      8168.33213      8168.35353      8218.35353      8221.37315      8223.90408      8273.90408      8275.50942      8275.81657      8278.53951      8328.53951      8330.05479      8330.68396      8380.68396      8381.15276      8382.81527      8384.52218      8385.33403      8435.33403      8435.72362      8437.45511      8487.45511      8489.16844      8490.77592      8540.77592      8541.95946      8544.72419       8545.3839       8595.3839      8598.45294      8599.16123      8649.16123      8650.03057      8654.12473      8654.31508      8655.07548      8705.07548      8705.85552      8708.65141      8709.21456       8709.5963       8759.5963      8759.71592      8763.13355      8763.39001      8813.39001      8813.65255      8817.15117      8817.22952      8867.22952      8867.30836      8870.18179      8870.82932      8872.71846      8922.71846      8924.59192      8925.46206      8927.87864      8977.87864      8978.51113      8978.63543      8981.90582      9031.90582      9032.53099      9033.03068      9035.37922      9085.37922      9086.63487      9087.32724      9089.53421      9139.53421      9140.55583      9141.59166      9191.59166      9192.70694      9194.67128      9195.91603      9245.91603      9248.04049      9251.14347      9251.18345      9301.18345      9301.21018      9301.43494      9304.89717      9305.99353      9355.99353      9357.34299      9360.51133      9410.51133      9411.53959      9414.59209      9464.59209      9466.50007      9469.90436      9470.24885      9520.24885      9520.58906      9523.95115      9525.38826      9575.38826      9576.37009      9578.70443      9580.06152      9580.67699      9630.67699      9633.65272      9635.86202      9685.86202      9687.40782      9690.56353      9740.56353      9744.40169      9745.04303      9745.32208      9795.32208      9795.78432      9796.01688      9799.66225      9849.66225      9849.78385      9851.60795      9853.63281      9903.63281      9904.83162       9908.2542      9909.53664      9959.53664       9960.0013      9962.41146      9962.77323           10000];
    pause_block1 = zeros(1,length(time_block1));
 
    x_block2 = [2.9157           5       3.957       3.957       3.857      3.7574      3.7574     0.46142     0.46142      1.9893           5      3.7977      3.7977      2.0454           0      2.6686      2.6686      3.3124      4.9998           5      4.7253      4.7253           5      2.6835      2.6647      2.6647      2.5038           0           5      4.0308      4.0308      3.9853      3.8957      3.8957           0     0.33937      2.1447      2.1447           5      3.4208      3.4208           0      4.3622      4.3622      3.1138      2.3226      2.3226           5      4.2436      4.1312      4.1312           5           0      2.6554      2.6554      1.5705           0      3.3241      3.3241           5      1.9504      1.9504      2.4261      3.4663      3.4663      1.0506     0.83201     0.83201           0      0.3544           5      2.8948      2.8948           0       2.684      3.8922      3.8922           5      4.7665       2.509       2.509           5           0      1.4262      1.4262     0.85023           0    0.084758    0.084758     0.26954     0.42831     0.42831           0      2.2164      2.5208      2.5208           5           0     0.85746     0.85746        2.08           5      3.1151      3.1151           5      2.7087       1.319       1.319           0      3.7753           5      3.3552      3.3552           0      1.8808      1.8808      2.5145      3.8223      3.8223      4.3432           5      4.7557      4.7557           0     0.90988     0.90988           5      2.4645      2.4645       4.938           5       4.069       4.069         4.1      4.2151      4.2151      3.8755      1.6823      1.6823           5      4.0457      4.0457           5      4.9258      2.5684      2.5068      2.5068           5      1.0907      1.0907      4.6132           5      2.2348      2.2348           5     0.56395     0.56395           0           5      3.4518      3.0073      3.0073           5           0     0.66868     0.66868           5      2.3836      2.3836           0      1.9282      2.4971      2.4971           0           5      4.6048      4.6048           5      2.6086      2.6086      4.4677           5      4.8732      4.8732      1.7562      1.1175      1.1175           5      3.2583      3.2583           5       3.894      1.8983      1.8983           5      0.7761      0.7761     0.48054    0.013936    0.013936           0      1.1707      2.8239      2.8239           5      4.1597      4.1597           0      1.7106      1.7106           5      2.5508      2.5508           0      3.0116      3.0116      2.3014     0.58462     0.58462           0     0.99945      2.2146      2.2146      2.8648           5      4.5659      4.5659      4.5409      4.2827      4.1784      4.1784           0      4.4821      4.4821           0      1.3974      1.3974     0.89961           0     0.69673       0.956       0.956           0      4.8958      4.8958      1.4634      1.4634           0           5      3.4285      3.4285      1.7976      1.7976           0           5      4.5229      4.5229      3.8382      3.5535      3.5535           0      1.0734      1.0734      1.2523       2.245       2.245       2.737      4.3638      4.3638           5       2.541       2.541      2.5532       4.936           5      4.3241      4.3241     0.37698           0       3.761       3.761           5      4.6753      3.7773      3.7773           0      1.4286      1.4286           0     0.59001      2.1737      2.1737           5           0      1.0198      1.0198     0.54026           0      1.9876      2.9563      2.9563           0      2.0279      2.0279           0      3.7951      3.7951       4.315      4.8574      4.8574           5      1.4977      1.4977           5      4.5944      4.4434      4.4434      3.4287      2.7591      2.7591           5      2.2575      2.2575           5      1.4822      1.1808      1.1808      1.2209       2.103      2.1791      2.1791      1.3563     0.69629     0.69629      3.1243           5      2.1295      2.1295           0      3.3641           5      4.4344      4.4344           0      3.2681      3.2681      3.8904           5      2.7015      2.7015           0     0.23411     0.23411           0      3.7375      4.3211      4.3211           5      2.4207     0.88948     0.88948           5      1.9433      1.9433           0      2.9277      2.9277           0     0.57301     0.57301           5      2.6436      2.6436      1.6738           0      2.8655      2.8655      1.6524           0     0.91578     0.91578      2.2197           5      3.7519      3.7519      4.7046           5      3.8552      3.8552      1.8328     0.56982     0.56982           0      1.4767           5      4.6505      4.6505     0.40145     0.40145           5       3.796       3.796           0     0.84165     0.84165           0     0.16832      3.7824      3.7824           5      1.0907      1.0907           5      1.6777      1.6777           5      4.6778      4.6778      3.7345      3.4173      3.4173      2.5031      1.5867      1.5867      3.5176      3.5626      3.5626           0           5       4.874       4.874      4.1192      2.0079      1.7597      1.7597      3.8241           5      4.6693      4.6693           0      1.7168      1.7168           0      3.4145      3.4145           5      3.1463      3.1463           5      4.2082      3.5351      3.5351           5      3.0994      1.0981      1.0981      2.1351       4.125       4.125      4.2863           5        3.98        3.98       2.193     0.28118     0.28118           5      4.9486      4.3603      4.3603      1.2598      1.2598    0.066853           0     0.77127     0.77127     0.75099     0.73551     0.73551      3.6216           5      4.0888      4.0888      1.8631     0.81385     0.81385           0     0.83932      1.6342      1.6342           5      1.0415      1.0415     0.25649           0   0.0060556   0.0060556           5      1.5598      1.5598           0      2.1394       3.426       3.426           0      2.6672      2.6672      2.7111       2.717       2.717           0      1.8313      2.1785      2.1785      2.2047           5      3.5144      3.0039      3.0039           0      1.2017      2.9177      2.9177           5      1.7059      1.7059      1.9952      2.2708      2.2708           0      4.1467      4.1467           0      1.4057      1.4057           0      4.3672      4.3672           5       4.196      2.9217      2.9217      3.1232      3.1641      3.1641           5     0.27071           0      1.7584      1.7584           5      4.4121      2.6744      2.6744      3.0163      3.3492      3.3492      1.2753           0      1.2691      1.2691           5      4.7825      4.7665      4.7665      4.7694           5      3.9157      3.3111      3.3111        4.27           5       4.808       4.808           5      1.7457           0      1.3259      1.3259           0      3.2834      3.2834      3.3022      3.3226      3.3226      3.3439      3.3782      3.3782           5      1.1041      1.1041      2.5074      3.4454      3.4454      3.7368      4.9562           5      4.6439      4.6439       3.921      3.7573      3.7573           0      1.7765      3.2338      3.2338           0     0.99118      2.8078      2.8078           0       3.284       3.284      4.3503           5      4.4686      4.4686      3.3861      3.0372      3.0372       3.334      3.8905      3.8905           5           0      2.4115      2.4115           0      1.9143      1.9143           0      1.2464      1.2464           5      2.7385      2.7385       1.782     0.45554     0.45554           5       1.734       1.734     0.26564           0      1.2967      1.2967           0           5      3.4823      3.4823           0       2.203       2.203];
    y_block2 = [3.4913      3.8602      4.0448      4.0448           0       4.033       4.033      3.6036      3.6036           5      2.2483      1.1494      1.1494           0      1.3417      3.0922      3.0922           5           0    0.000575     0.81447     0.81447      1.2581           5      4.9697      4.9697           5      4.5285      3.5868      3.4042      3.4042           5      1.8566      1.8566      4.7481           5        3.66        3.66      4.2637      4.5977      4.5977       3.025      1.0196      1.0196           5      2.4774      2.4774      4.4443           5      4.9174      4.9174      4.9078      4.8521      4.8225      4.8225           5      4.7431      4.1993      4.1993      3.2883      1.6305      1.6305           0      3.5654      3.5654           0     0.32259     0.32259    0.096363           0      1.2632      1.8356      1.8356      3.4776           5      4.3146      4.3146      4.8807           5      3.8464      3.8464      3.6884      3.3711      3.2806      3.2806           5      2.4617      2.2087      2.2087           5      2.6017      2.6017      2.1803           0     0.29941     0.29941     0.53966      1.0242      1.1073      1.1073           0      2.6446      4.3518      4.3518      2.3877           0      1.4481      1.4481      1.0732           0     0.34814     0.81569     0.81569      1.2469      1.4886      1.4886           0      3.0715      3.0715           5      2.5685       1.664       1.664     0.74472     0.56885     0.56885      2.1083      3.0626      3.0626           0    0.076781      1.2294      1.2294           0      4.5693      4.5693           5       2.218       2.218      2.6845      2.8187      2.8187      4.8427           5           0     0.13069     0.13069     0.82195      1.9058      1.9058           0     0.20926      1.7053      1.7053      2.3105      3.2813      3.2813      3.0211     0.71428           0     0.20511     0.20511     0.22894     0.28874     0.29674     0.29674     0.94353      1.3342      1.3342      3.3607           5      4.5164      4.5164      4.4951      4.4524       4.449       4.449      4.2448      3.0089      3.0089           0     0.86154      1.0668      1.0668           5      4.1941      4.1941      3.5445      3.2532      3.2532      4.3215           5      3.7758      3.7758      3.1418      2.2784      2.2784           0      3.5969      3.5969      3.6134           5      3.0419      3.0419      1.3297     0.66854     0.66854     0.29924     0.14737     0.14737      2.7798      4.7398      4.7398      4.5765      4.3837      4.3837           5        3.51        3.51      4.0599           5       3.857       3.857           5      1.2467     0.48361     0.48361           0           5       2.982       2.982      2.1452      1.2475      1.2475      2.9196      3.4409      3.4409           5      2.1823           0     0.81206     0.81206     0.97673        1.82        1.82      4.7866      4.7866      4.5299      3.6531      3.3775      3.3775     0.03279     0.03279     0.52926      1.9102       2.042       2.042           5      3.7699      3.7699      1.4494     0.74852     0.74852           0      4.1519      4.1519           5      2.1962      2.1962      2.7672      4.9745      4.9745           5           0     0.13431      1.5525      1.5525           0     0.14828      1.6276      1.6276      4.2997           5      3.0633      3.0633      2.3509      2.0815      2.0815      4.1469           5      2.7102      2.7102      3.1387      3.8968      4.0514      4.0514           5      3.9314           0      1.9161      1.9161      3.7434      4.9968      4.9968      4.1985      2.7044      2.7044           0       2.821       2.821      2.8625      3.8801      3.8801      4.8838           5      4.9567      4.9567           0      3.2713      3.2713      1.9226     0.27193     0.27193      2.3432           5      4.7723      4.7723           5           0     0.43147     0.43147           5      1.3356      1.3356           0      1.0318      2.6108      2.6108      3.5369           5      4.2885      4.0425      4.0425      2.1157     0.69558     0.69558           0      1.2402      3.8092      3.8092      2.2122      2.0738      2.0738      2.2463           5        4.57        4.57      3.6178           0      2.1477      2.1477     0.99608     0.13971     0.13971      2.0167      4.8445      4.8445      3.5085       3.247       3.247      4.1218      4.5874      4.5874           5      4.2878      3.0686      3.0686           5       2.369     0.91088     0.91088           0      1.9423      2.8142      2.8142           0     0.87252       4.254       4.254           0      2.6566      2.6566      3.3091           5     0.96569      0.5655      0.5655      4.8948      4.8948      2.7822      2.2291      2.2291      4.2333      4.6777      4.6777      4.9463           5      3.8467      3.8467      3.2363      1.2765      1.2765      2.0158       2.644       2.644      4.6892      4.8875      4.8875           0      1.6433      1.6433           0      1.6472      1.6472           5      4.9219      4.9219       4.221      3.2374      3.2126      3.2126           5           0     0.58767     0.58767           5      2.4867        1.78        1.78      2.3184      2.5163      2.5163      2.6577      2.9388      2.9388      3.2542       3.623       3.623      1.0844           0     0.92175     0.92175      2.6969           5      2.5747      2.5747           5     0.34669     0.34669           0      1.5341      3.7267      3.7267           0      3.9872      3.9872    0.042971           0     0.49168     0.49168      2.1369      2.1369           5      4.8396      2.9885      2.9885           0      2.2803      2.2803           5       3.701      2.8423      2.8423           5      3.9828      3.9828      2.0221           0      1.9149      1.9149      2.2496      2.6432      2.6432           5        4.23      4.2118      4.2118      4.5245      4.7399      4.7399      2.7413           0      1.6485      1.6485       1.853      2.0122      2.0122           5      4.6003      4.6003      4.8391           5      4.9695      4.9695           5      1.7351           0     0.59623     0.59623     0.17037           0     0.24326     0.24326      1.0807      2.4055      2.4055           0      2.2921      2.2921       3.221      4.9172      4.9172      4.2002      3.9572      3.9572      3.4628      1.9269      1.9269      3.2804           5      2.2745      2.2745           5      4.4474      4.4474       4.602           5      4.9772      4.8292      4.8292     0.74135           0      2.1913      2.1913           5       2.266       2.266           0      1.3934        2.78        2.78     0.15317           0     0.01125     0.01125           0     0.87678           5      2.7008      2.7008           0      2.0559      2.5968      2.5968      2.4521           0      1.3154      2.3145      2.3145         2.4       2.612       2.612           5      2.3964      2.3964           0       3.863       3.863      3.2529      1.7875      1.7875           0       1.195       1.195           0           5      4.8204      3.3601      3.3601           0     0.76131     0.76131      3.6392           5      3.8838      3.8838     0.91115           0      1.6699      1.6699      1.5374      1.3824      1.3824           0     0.84227      1.5312      1.5312           5       3.882       3.882           5      2.9035      2.9035      2.7751      2.1962      2.3586      2.3586      1.1097     0.43152     0.43152      0.5473     0.62269     0.62269      2.5392       3.694       3.694           5      3.1889      3.1889      3.1149      3.0617      3.0617           0     0.55388      3.2576      3.2576       3.384      3.8715      4.0195      4.0195      3.7169      3.5255      3.5255];
    time_block2 = [0      1.41115725      2.1173294      52.1173294      54.8147097      57.504173      107.504173      109.720084      159.720084      161.100008      163.819165      164.905065      214.905065      216.302155      217.932939      220.060631      270.060631      271.402951      274.920979      274.921384      275.494042      325.494042      325.841914      328.775829      328.799594      378.799594      378.908772      380.607322      383.999256      384.656761      434.656761      435.721027      437.817503      487.817503      491.051842      491.333605      492.832448      542.832448      544.778078      545.854157      595.854157      598.364141      601.564848      651.564848      654.345906      656.108381      706.108381       708.32319      708.948895      709.041876      759.041876      759.621107      762.954647      764.725037      814.725037      815.457928       816.51885      818.764394      868.764394      870.036041      872.350069      922.350069      923.482421      925.958423      975.958423      978.829555      979.089333      1029.08933      1029.66415      1029.90899       1033.1185      1034.57294      1084.57294      1086.79164      1088.84876      1089.77482      1139.77482      1140.60418      1140.77895       1142.4691       1192.4691      1194.13313      1197.47317      1198.42585      1248.42585      1249.63469      1251.41927      1251.59717      1301.59717      1303.46211      1305.06451      1355.06451      1355.46504      1357.53776      1357.82239      1407.82239      1409.48294      1412.83189      1413.40621      1463.40621      1464.50586      1467.13225       1468.8276       1518.8276      1520.64241      1522.84856       1524.1866       1574.1866      1575.10077      1577.71734      1578.56616      1579.70613      1629.70613      1631.96133      1633.22549      1683.22549      1684.30409      1686.52962      1736.52962      1737.86137      1739.54048       1740.1651       1790.1651      1793.39423      1794.01205      1844.01205      1846.92554      1848.73167      1898.73167      1901.35617      1901.42197      1902.40974      1952.40974      1953.22963      1956.27677      2006.27677      2006.64244      2009.00413      2059.00413      2061.23766       2061.8801       2111.8801      2113.37189      2113.48786      2117.17311      2117.26944      2167.26944      2168.99429       2171.6988       2221.6988      2224.36881      2224.66199      2226.75795      2276.75795      2278.64503      2281.67239      2331.67239      2332.08644      2335.75745      2336.89411      2337.22051      2387.22051       2388.5491      2391.88267      2392.32849      2442.32849      2445.24805      2447.01167      2497.01167      2499.09738      2500.78465      2501.28241      2551.28241       2552.9472      2556.28066      2556.54415      2606.54415      2606.84075      2608.63535      2658.63535      2660.99331      2661.66846      2661.82935      2711.82935      2715.17501      2715.86054      2765.86054      2768.48485       2769.6621       2819.6621      2821.02425      2821.88929      2823.45012      2873.45012      2875.56071      2878.43486      2928.43486      2929.96654      2932.38459      2982.38459      2982.39899      2983.60877      2985.31726      3035.31726      3037.16317      3037.87602      3087.87602      3090.66003      3091.80494      3141.80494      3144.61363       3146.7049       3196.7049      3198.40893      3200.42075      3250.42075      3251.04762      3252.56311      3302.56311      3303.09818      3304.01293      3305.12511      3355.12511       3356.0018      3358.88054      3359.46583      3409.46583      3409.78867      3413.12644      3414.47355      3464.47355      3467.31449      3470.36191      3520.36191      3523.55115      3524.54545      3574.54545      3575.63654      3577.60843      3579.13564      3579.70393      3629.70393      3630.35065      3633.66256      3683.66256      3686.68699      3736.68699      3737.67751      3741.06171      3742.12537      3792.12537      3794.60617      3844.60617      3845.84942      3849.30755      3849.63752      3899.63752      3901.66167      3902.50341      3952.50341      3955.33278      3956.18743      4006.18743      4006.70051      4009.54646      4059.54646      4060.20012      4062.36116      4112.36116      4112.93109      4115.13397      4165.13397      4165.15282      4168.84533      4168.94451      4169.99186      4219.99186      4222.81952      4223.08959      4225.78387      4275.78387      4277.74752       4278.2621      4279.68529      4329.68529      4332.24788      4333.21704      4383.21704      4384.89128      4385.58276      4387.43881      4437.43881      4439.34454      4442.71597      4443.40363      4493.40363      4494.11223      4494.91051      4497.84735      4499.27874      4549.27874       4551.5957      4553.18504      4603.18504      4604.63797        4607.357        4657.357      4659.19295      4661.10809      4711.10809      4711.20712      4713.63855      4763.63855       4766.0674      4766.34872      4766.45341      4816.45341      4819.82643      4822.05252      4872.05252      4873.79616      4875.93009      4925.93009      4928.22126      4931.16015      4931.41199      4981.41199      4981.56612      4984.95092      4985.24301      5035.24301       5038.3377      5040.81995      5090.81995      5092.66734      5094.09453      5096.27864      5146.27864      5147.82673      5150.27236      5151.46166      5151.87283      5201.87283      5205.09615      5207.47167      5257.47167      5258.09389      5259.20331      5261.50141      5311.50141      5313.59359       5313.7749       5363.7749      5363.96876      5367.06368      5367.54696      5417.54696      5418.32658      5421.28866      5423.04709      5473.04709      5475.89295       5478.0092       5528.0092      5529.81038      5532.52397      5582.52397      5584.66942      5585.08932      5635.08932      5638.09771        5639.699        5689.699      5690.40161      5691.61432      5693.69035      5743.69035      5745.21084       5747.2821      5748.42999      5798.42999      5799.49036       5801.7514       5802.7664       5852.7664      5854.74713      5855.36124      5857.74122      5907.74122      5910.88139      5912.84244      5962.84244      5963.41995      5964.91659      5968.48741      5968.84161      6018.84161      6022.88565      6072.88565      6076.25937      6077.14269      6127.14269      6130.00442      6130.63893      6180.63893      6181.22791       6181.3457      6183.87482      6233.87482      6234.78281      6237.69819      6287.69819      6290.35061      6292.60474      6342.60474      6345.20563      6345.45788      6395.45788      6398.77637      6399.89212      6449.89212      6451.14578      6452.40243      6502.40243      6504.98179      6505.04191      6555.04191      6557.46249      6560.85971      6560.94532      6610.94532       6612.2388      6615.85713       6616.2824       6666.2824         6669.53      6671.37982      6671.90003      6721.90003      6725.03353      6726.18568      6776.18568      6777.33411      6779.61818      6829.61818      6830.69586      6831.95587      6881.95587      6884.05144      6884.94656      6885.70745      6935.70745      6937.24178      6939.23249      6941.32877      6991.32877      6993.08724      6996.46118      7046.46118      7046.71609      7047.84412      7049.45626      7099.45626      7102.21159       7105.1595       7155.1595      7159.25959      7159.30426      7159.81537      7209.81537      7212.15536      7262.15536      7264.22317      7264.33905      7265.67593      7315.67593       7317.6683      7319.18853      7369.18853      7371.83228      7373.09497      7373.92968      7423.92968      7425.99625       7426.9705       7476.9705      7478.38578      7479.84535      7481.22758      7531.22758      7533.48253      7536.13454      7586.13454      7587.79062      7588.33171      7588.34449      7638.34449       7641.6803      7643.97824      7693.97824      7695.66842      7697.98664       7699.3807       7749.3807      7751.66875      7753.45007      7803.45007      7805.44217      7805.70864      7855.70864      7857.52696      7858.75253      7858.98491      7908.98491      7909.01168      7911.87706      7913.39987      7913.92314      7963.92314      7965.94578      7966.75495      7967.91034      8017.91034      8019.40662      8021.77362      8071.77362      8073.38883      8074.92788      8124.92788      8126.56351      8129.55033      8179.55033      8182.35581      8183.30686      8233.30686      8234.30028      8237.38653      8287.38653      8288.38266      8289.64816      8291.65397      8341.65397      8343.47596      8343.84535      8393.84535      8395.07364      8398.23765      8398.41876      8399.59515      8449.59515      8453.07326      8453.70403      8455.56852      8505.56852      8507.45478       8509.2909       8559.2909      8561.33877        8562.598       8563.8512       8613.8512      8616.89311      8617.07048       8617.0835       8667.0835      8667.09126      8667.69565      8670.53792      8672.12283      8722.12283      8724.03348      8725.48793      8725.87056      8775.87056      8776.03086      8778.74734      8780.20453      8781.31132      8831.31132      8832.19711      8834.39057      8884.39057      8885.98262       8887.7184       8937.7184      8939.31607      8941.89148      8991.89148      8993.04661      8995.82151      9045.82151      9047.33652       9048.3493       9098.3493      9099.16929      9102.60032      9102.72355      9103.72562      9153.72562      9156.01694      9156.53609      9206.53609      9209.69129      9211.18316       9212.4069       9262.4069      9265.33523      9266.23279      9267.87781      9317.87781      9319.75175      9321.94354      9371.94354      9373.10741      9373.81657      9374.39664      9424.39664      9426.81913      9427.59988      9477.59988      9478.37099      9479.81707      9529.81707      9530.56166      9533.91726      9535.46857      9585.46857      9587.10344      9588.45737      9638.45737      9639.73591      9640.56837      9690.56837      9693.37808      9695.07091      9745.07091      9746.15015      9747.64672      9797.64672      9800.67676      9802.85437      9852.85437      9855.11813      9855.52765      9857.52671      9907.52671      9908.39526       9911.7444      9912.76099      9962.76099      9965.09128      9966.56549           10000];
    pause_block2 = zeros(1, length(time_block2));
end


for ind=2:length(time_block1)
    if(time_block1(ind) - time_block1(ind-1) == t_p)
        pause_block1(ind-1) = 1;
    else
        pause_block1(ind-1) = 0;
    end
end

for ind=2:length(time_block2)
    if(time_block2(ind) - time_block2(ind-1) == t_p)
        pause_block2(ind-1) = 1;
    else
        pause_block2(ind-1) = 0;
    end
end

p = [1.25 3.75 3.75 1.25]; 
q = [1.25 1.25 3.75 3.75]; %Location of LED
a = 2.5; b = 2.5; %Location of PD
r = 0.4; %Blockage radius

% pause_prob = 0.79; %Tp = 10s
% pause_prob = 0.97; %Tp = 100s
% pause_prob = 0.79; %Tp = 300s
pause_prob = 0.95; %Tp = 50s
%Vary pause time

for led_ind = 1:length(p)

m = (b-q(led_ind))/(a-p(led_ind));    
c = -p(led_ind)*(b-q(led_ind))/(a-p(led_ind)) + q(led_ind);

%CD: y = mx+c1
c1 = r/2 * sqrt(1+m^2) + c;
CD = y == m*x + c1;
CD_m = m;
CD_c = c1;

%AB: y = mx+c2
c2 = -r/2 * sqrt(1+m^2) + c;
AB = y == m*x + c2;
AB_m = m;
AB_c = c2;


%Line of minimum of distance (AD)
AD = y == -1/m*x + (24*b)/43 + (19*q(led_ind))/43 ...
    + ((a-p(led_ind))*(24*a/43 + 19*p(led_ind)/43))/(b-q(led_ind));
AD_m = -1/m;
AD_c = 24*b/43 + 19*q(led_ind)/43 + ((a-p(led_ind))*((24*a)/43 + 19*p(led_ind)/43))/(b-q(led_ind));

%Point D
[Dx, Dy] = solve([CD, AD], [x,y]);

%Point A
[Ax, Ay] = solve([AD, AB], [x,y]);

Axc = x == Ax;

%Point F
[Fx, Fy] = solve([CD, Axc],[x, y]);

Dxc = x == Dx;

%Point H (for LED = (3.75,3.75) and (1.25, 3.75))
[Hx, Hy] = solve([AB, Dxc], [x,y]);

%Line EG (variable line)
EG = y == -1/m * x + p(led_ind)/m + q(led_ind) + d;
EG_m = -1/m;
EG_c = p(led_ind)/m + q(led_ind) + d;

%Point E
[Ex, Ey] = solve([CD, EG],[x, y]);

%Point G
[Gx, Gy] = solve([AB, EG], [x,y]);


%1. LED (1.25, 1.25) __________________________________
if (p(led_ind) == 1.25 && q(led_ind) == 1.25)   
    prob_left1 = integrate(x,y,pause_prob, AD_m, AD_c, CD_m, CD_c, Dx, Ex);
    prob_mid1 = integrate(x,y, pause_prob, AD_m, AD_c, EG_m, EG_c, Ex, Fx);
    prob_right1 = integrate(x,y, pause_prob, AB_m, AB_c, EG_m, EG_c, Fx, Gx);

    prob_total1 = prob_left1 + prob_mid1 + prob_right1;

    prob_left2 = integrate(x,y,pause_prob, AD_m, AD_c, CD_m, CD_c, Dx, Ax);
    prob_mid2 = integrate(x,y,pause_prob, AB_m, AB_c, CD_m, CD_c, Ax, Ex);
    prob_right2 = integrate(x,y,pause_prob, AB_m, AB_c, EG_m, EG_c, Ex, Gx);

    prob_total2 = prob_left2 + prob_mid2 + prob_right2;

    prob_totA = prob_total1 + prob_total2;
    
    %d value range
    dlA = sqrt((p(led_ind)-a)^2 + (q(led_ind)-b)^2)*(1 - 0.95/2.15);
    d_startA = dlA*sqrt(1+(-1/m)^2);
    d_midA = Fy + Fx/m -p(led_ind)/m - q(led_ind);
    d_endA = b + a/m - p(led_ind)/m - q(led_ind);

    d_plotA = d_startA : 0.001 : d_endA;
    prob_finalA = zeros(1, length(d_plotA));

    for i = 1:length(d_plotA)
        if (d_plotA(i)) >= (d_startA) && (d_plotA(i)) <= (d_midA)
            prob_finalA(i) = subs(prob_total1, d, d_plotA(i));
        elseif (d_plotA(i)) >= (d_midA) && (d_plotA(i)) <= abs(d_endA)
            prob_finalA(i) = subs(prob_total2, d, d_plotA(i));
        else
            prob_finalA(i) = 0;
        end   
    end
    
    dist_plotA = abs(d_plotA)/sqrt(1 + (-1/m)^2);
    
    %Calculation of probability blockage #Simulation
%     prob_block_A1 = zeros(1,length(dist_LEDA1));
%     for ind = 1:length(dist_LEDA1)
%         if(dist_LEDA1(ind) ~= 0)
% %             prob_block_A1(ind) = subs(prob_totA, d, dist_LEDA1(ind));
%             if(dist_LEDA1(ind) >= d_startA && dist_LEDA1(ind) <= d_midA)
%               prob_block_A1(ind) = subs(prob_total1, d, dist_LEDA1(ind));  
%             elseif(dist_LEDA1(ind) >= d_midA && dist_LEDA1(ind) <= d_endA)
%               prob_block_A1(ind) = subs(prob_total2, d, dist_LEDA1(ind));  
%             end
%         else
%             prob_block_A1(ind) = 0;
%         end
%     end
%     
%     prob_block_A2 = zeros(1,length(dist_LEDA2));
%     for ind = 1:length(dist_LEDA2)
%         if(dist_LEDA2(ind) ~= 0)
%             if(dist_LEDA2(ind) >= d_startA && dist_LEDA2(ind) <= d_midA)
%               prob_block_A2(ind) = subs(prob_total1, d, dist_LEDA2(ind));  
%             elseif(dist_LEDA2(ind) >= d_midA && dist_LEDA2(ind) <= d_endA)
%               prob_block_A2(ind) = subs(prob_total2, d, dist_LEDA2(ind));  
%             end
%         else
%             prob_block_A2(ind) = 0;
%         end
%     end
    
%2. LED (3.75, 1.25) __________________________________
elseif (p(led_ind) == 3.75 && q(led_ind) == 1.25)
    prob_left1 = integrate(x,y,pause_prob, AB_m, AB_c, EG_m, EG_c, Gx, Ax);
    prob_mid1 = integrate(x,y, pause_prob, AD_m, AD_c, EG_m, EG_c, Ax, Ex);
    prob_right1 = integrate(x,y, pause_prob, AD_m, AD_c, CD_m, CD_c, Ex, Dx);

    prob_total1 = prob_left1 + prob_mid1 + prob_right1;
    
    prob_left2 = integrate(x,y,pause_prob, AB_m, AB_c, EG_m, EG_c, Gx, Ex);
    prob_mid2 = integrate(x,y,pause_prob, AB_m, AB_c, CD_m, CD_c, Ex, Ax);
    prob_right2 = integrate(x,y,pause_prob, AD_m, AD_c, CD_m, CD_c, Ax, Dx);

    prob_total2 = prob_left2 + prob_mid2 + prob_right2;

    prob_totB = prob_total1 + prob_total2;
    
    dlB = sqrt((p(led_ind)-a)^2 + (q(led_ind)-b)^2)*(1 - 0.95/2.15);
    d_startB = dlB*sqrt(1+(-1/m)^2);
    d_midB = Fy + Fx/m -p(led_ind)/m - q(led_ind);
    d_endB = b + a/m - p(led_ind)/m - q(led_ind);
    
    d_plotB = d_startB : 0.001 : d_endB;
    prob_finalB = zeros(1, length(d_plotB));

    for i = 1:length(d_plotB)
        if d_plotB(i) >= d_startB && d_plotB(i) <= d_midB
            prob_finalB(i) = subs(prob_total1, d, d_plotB(i));
        elseif d_plotB(i) >= d_midB && d_plotB(i) <= d_endB
            prob_finalB(i) = subs(prob_total2, d, d_plotB(i));
        else
            prob_finalB(i) = 0;
        end   
    end
    
    dist_plotB = abs(d_plotB)/sqrt(1 + (-1/m)^2);
    
    
    %Calculation of probability blockage #Simulation
%     prob_block_B1 = zeros(1,length(dist_LEDB1));
%     for ind = 1:length(dist_LEDB1)
%         if(dist_LEDB1(ind) ~= 0)
%             if(dist_LEDB1(ind) >= d_startB && dist_LEDB1(ind) <= d_midB)
%               prob_block_B1(ind) = subs(prob_total1, d, dist_LEDB1(ind));  
%             elseif(dist_LEDB1(ind) >= d_midB && dist_LEDB1(ind) <= d_endB)
%               prob_block_B1(ind) = subs(prob_total2, d, dist_LEDB1(ind));  
%             end
%         else
%             prob_block_B1(ind) = 0;
%         end
%     end
%     
%     prob_block_B2 = zeros(1,length(dist_LEDB2));
%     for ind = 1:length(dist_LEDB2)
%         if(dist_LEDB2(ind) ~= 0)
%             if(dist_LEDB2(ind) >= d_startB && dist_LEDB2(ind) <= d_midB)
%               prob_block_B2(ind) = subs(prob_total1, d, dist_LEDB2(ind));  
%             elseif(dist_LEDB2(ind) >= d_midB && dist_LEDB2(ind) <= d_endB)
%               prob_block_B2(ind) = subs(prob_total2, d, dist_LEDB2(ind));  
%             end
%         else
%             prob_block_B2(ind) = 0;
%         end
%     end
    
  
%3. LED (3.75, 3.75)__________________________________    
elseif (p(led_ind) == 3.75 && q(led_ind) == 3.75)
    
    prob_left1 = integrate(x,y,pause_prob, EG_m, EG_c, CD_m, CD_c, Ex, Dx);
    prob_mid1 = integrate(x,y, pause_prob, EG_m, EG_c, AD_m, AD_c, Dx, Gx);
    prob_right1 = integrate(x,y, pause_prob, AB_m, AB_c, AD_m, AD_c, Gx, Ax);

    prob_total1 = prob_left1 + prob_mid1 + prob_right1;
    
    prob_left2 = integrate(x,y,pause_prob, EG_m, EG_c, CD_m, CD_c, Ex, Gx);
    prob_mid2 = integrate(x,y,pause_prob, AB_m, AB_c, CD_m, CD_c, Gx, Dx);
    prob_right2 = integrate(x,y,pause_prob, AB_m, AB_c, AD_m, AD_c, Dx, Ax);

    prob_total2 = prob_left2 + prob_mid2 + prob_right2;
    
    prob_totC = prob_total1 + prob_total2;

    dlC = sqrt((p(led_ind)-a)^2 + (q(led_ind)-b)^2)*(1 - 0.95/2.15);
    d_startC = -dlC*sqrt(1+(-1/m)^2); % -2.0651
    d_midC = Hy + Hx/m -p(led_ind)/m - q(led_ind); % -2.5567
    d_endC = b + a/m - p(led_ind)/m - q(led_ind); % -3.7
    
    d_plotC = (d_endC) : 0.001 : (d_startC);
    prob_finalC = zeros(1, length(d_plotC));

    for i = 1:length(d_plotC)
        if abs(d_plotC(i)) >= abs(d_startC) && abs(d_plotC(i)) <= abs(d_midC)
            prob_finalC(i) = subs(prob_total1, d, d_plotC(i));
        elseif abs(d_plotC(i)) > abs(d_midC) && abs(d_plotC(i)) <= abs(d_endC)
            prob_finalC(i) = subs(prob_total2, d, d_plotC(i));
        else
            prob_finalC(i) = 0;
        end   
    end
    
    dist_plotC = abs(d_plotC)/sqrt(1 + (-1/m)^2);
    
    %Calculation of probability blockage #Simulation
%     prob_block_C1 = zeros(1,length(dist_LEDC1));
%     for ind = 1:length(dist_LEDC1)
%         if(dist_LEDC1(ind) ~= 0)
%             if(dist_LEDC1(ind) >= abs(d_startC) && dist_LEDC1(ind) <= abs(d_midC))
%               prob_block_C1(ind) = subs(prob_total1, d, dist_LEDC1(ind));  
%             elseif(dist_LEDC1(ind) >= abs(d_midC) && dist_LEDC1(ind) <= abs(d_endC))
%               prob_block_C1(ind) = subs(prob_total2, d, dist_LEDC1(ind));  
%             end
%         else
%             prob_block_C1(ind) = 0;
%         end
%     end
%     
%     prob_block_C2 = zeros(1,length(dist_LEDC2));
%     for ind = 1:length(dist_LEDC2)
%         if(dist_LEDC2(ind) ~= 0)
%             if(dist_LEDC2(ind) >= abs(d_startC) && dist_LEDC2(ind) <= abs(d_midC))
%               prob_block_C2(ind) = subs(prob_total1, d, dist_LEDC2(ind));  
%             elseif(dist_LEDC2(ind) >= abs(d_midC) && dist_LEDC2(ind) <= abs(d_endC))
%               prob_block_C2(ind) = subs(prob_total2, d, dist_LEDC2(ind));  
%             end
%         else
%             prob_block_C2(ind) = 0;
%         end
%     end
   
    
    
%4. LED (1.25, 3.75)__________________________________
elseif (p(led_ind) == 1.25 && q(led_ind) == 3.75)
    
    prob_left1 = integrate(x,y,pause_prob, AB_m, AB_c, AD_m, AD_c, Ax, Gx);
    prob_mid1 = integrate(x,y, pause_prob, EG_m, EG_c, AD_m, AD_c, Gx, Dx);
    prob_right1 = integrate(x,y, pause_prob, EG_m, EG_c, CD_m, CD_c, Dx, Ex);

    prob_total1 = prob_left1 + prob_mid1 + prob_right1;
    
    prob_left2 = integrate(x,y,pause_prob, AB_m, AB_c, AD_m, AD_c, Ax, Dx);
    prob_mid2 = integrate(x,y,pause_prob, AB_m, AB_c, CD_m, CD_c, Dx, Gx);
    prob_right2 = integrate(x,y,pause_prob, EG_m, EG_c, CD_m, CD_c, Gx, Ex);

    prob_total2 = prob_left2 + prob_mid2 + prob_right2;
    
    prob_totD = prob_total1 + prob_total2;
    
    dlD = sqrt((p(led_ind)-a)^2 + (q(led_ind)-b)^2)*(1 - 0.95/2.15);
    d_startD = -dlD*sqrt(1+(-1/m)^2); % -2.0651
    d_midD = Hy + Hx/m -p(led_ind)/m - q(led_ind); % -2.5567
    d_endD = b + a/m - p(led_ind)/m - q(led_ind); % -3.7

    d_plotD = (d_endD) : 0.001 : (d_startD);
    prob_finalD = zeros(1, length(d_plotD));

    for i = 1:length(d_plotD)
        if abs(d_plotD(i)) >= abs(d_startD) && abs(d_plotD(i)) <= abs(d_midD)
            prob_finalD(i) = subs(prob_total1, d, d_plotD(i));
        elseif abs(d_plotD(i)) > abs(d_midD) && abs(d_plotD(i)) <= abs(d_endD)
            prob_finalD(i) = subs(prob_total2, d, d_plotD(i));
        else
            prob_finalD(i) = 0;
        end   
    end
    
    dist_plotD = abs(d_plotD)/sqrt(1 + (-1/m)^2);
    
    %Calculation of probability blockage #Simulation
%     prob_block_D1 = zeros(1,length(dist_LEDD1));
%     for ind = 1:length(dist_LEDD1)
%         if(dist_LEDD1(ind) ~= 0)
%             if(dist_LEDD1(ind) >= abs(d_startD) && dist_LEDD1(ind) <= abs(d_midD))
%               prob_block_D1(ind) = subs(prob_total1, d, dist_LEDD1(ind));  
%             elseif(dist_LEDD1(ind) > abs(d_midD) && dist_LEDD1(ind) <= abs(d_endD))
%               prob_block_D1(ind) = subs(prob_total2, d, dist_LEDD1(ind));  
%             end
%         else
%             prob_block_D1(ind) = 0;
%         end
%     end
%     
%     prob_block_D2 = zeros(1,length(dist_LEDD2));
%     for ind = 1:length(dist_LEDD2)
%         if(dist_LEDD2(ind) ~= 0)
%             if(dist_LEDD2(ind) >= abs(d_startD) && dist_LEDD2(ind) <= abs(d_midD))
%               prob_block_D2(ind) = subs(prob_total1, d, dist_LEDD2(ind));  
%             elseif(dist_LEDD2(ind) >= abs(d_midD) && dist_LEDD2(ind) <= abs(d_endD))
%               prob_block_D2(ind) = subs(prob_total2, d, dist_LEDD2(ind));  
%             end
%         else
%             prob_block_D2(ind) = 0;
%         end
%     end


end %end if


end %end for


% p_desired = interp1(dist_plotA, prob_finalA, 1.6)


coord_PD = sprintf(' (%.2f, %.2f) ', a, b);
text_PD1 = sprintf(' Coordinate of PD: ');
text_PD = strcat(text_PD1, coord_PD);

figure(1);
subplot(2,2,3);
    plot(dist_plotA, prob_finalA, 'linewidth', 1.5);
    coord_LEDA = sprintf(' (%.2f, %.2f) ', p(1), q(1));
    text_LEDA = sprintf('Coordinate of LED: ');
    text_titleA1 = strcat(text_LEDA, coord_LEDA);
    text_titleA = strcat(text_titleA1, text_PD);
    title(text_titleA);
    xlabel('Distance from base of LED (in m)');
    ylabel('Blockage probability P_B(d)');
subplot(2,2,4);
    plot(dist_plotB, prob_finalB, 'linewidth', 1.5);
    coord_LEDB = sprintf(' (%.2f, %.2f) ', p(2), q(2));
    text_LEDB = sprintf('Coordinate of LED: ');
    text_titleB1 = strcat(text_LEDB, coord_LEDB);
    text_titleB = strcat(text_titleB1, text_PD);
    title(text_titleB);
    xlabel('Distance from base of LED (in m)');
    ylabel('Blockage probability P_B(d)');
subplot(2,2,2);
    plot(dist_plotC, prob_finalC, 'linewidth', 1.5);
    coord_LEDC = sprintf(' (%.2f, %.2f) ', p(3), q(3));
    text_LEDC = sprintf('Coordinate of LED: ');
    text_titleC1 = strcat(text_LEDC, coord_LEDC);
    text_titleC = strcat(text_titleC1, text_PD);
    title(text_titleC);
    xlabel('Distance from base of LED (in m)');
    ylabel('Blockage probability P_B(d)');
subplot(2,2,1);
    plot(dist_plotD, prob_finalD, 'linewidth', 1.5);
    coord_LEDD = sprintf(' (%.2f, %.2f) ', p(4), q(4));
    text_LEDD = sprintf('Coordinate of LED: ');
    text_titleD1 = strcat(text_LEDD, coord_LEDD);
    text_titleD = strcat(text_titleD1, text_PD);
    title(text_titleD);
    xlabel('Distance from base of LED (in m)');
    ylabel('Blockage probability P_B(d)');
    
prob_blockA1 = zeros(1, length(dist_LEDA1));    
for index = 1:length(dist_LEDA1)
    if (dist_LEDA1(index) ~= 0)
        prob_blockA1(index) = interp1(dist_plotA, prob_finalA, dist_LEDA1(index));
    else
        prob_blockA1(index) = 0;
    end
end

prob_blockB1 = zeros(1, length(dist_LEDB1));    
for index = 1:length(dist_LEDB1)
    if (dist_LEDB1(index) ~= 0)
        prob_blockB1(index) = interp1(dist_plotB, prob_finalB, dist_LEDB1(index));
    else
        prob_blockB1(index) = 0;
    end
end

prob_blockC1 = zeros(1, length(dist_LEDC1));    
for index = 1:length(dist_LEDC1)
    if (dist_LEDC1(index) ~= 0)
        prob_blockC1(index) = interp1(dist_plotC, prob_finalC, dist_LEDC1(index));
    else
        prob_blockC1(index) = 0;
    end
end

prob_blockD1 = zeros(1, length(dist_LEDD1));    
for index = 1:length(dist_LEDD1)
    if (dist_LEDD1(index) ~= 0)
        prob_blockD1(index) = interp1(dist_plotD, prob_finalD, dist_LEDD1(index));
    else
        prob_blockD1(index) = 0;
    end
end


prob_blockA2 = zeros(1, length(dist_LEDA2));    
for index = 1:length(dist_LEDA2)
    if (dist_LEDA2(index) ~= 0)
        prob_blockA2(index) = interp1(dist_plotA, prob_finalA, dist_LEDA2(index));
    else
        prob_blockA2(index) = 0;
    end
end

prob_blockB2 = zeros(1, length(dist_LEDB2));    
for index = 1:length(dist_LEDB2)
    if (dist_LEDB2(index) ~= 0)
        prob_blockB2(index) = interp1(dist_plotB, prob_finalB, dist_LEDB2(index));
    else
        prob_blockB2(index) = 0;
    end
end

prob_blockC2 = zeros(1, length(dist_LEDC2));    
for index = 1:length(dist_LEDC2)
    if (dist_LEDC2(index) ~= 0)
        prob_blockC2(index) = interp1(dist_plotC, prob_finalC, dist_LEDC2(index));
    else
        prob_blockC2(index) = 0;
    end
end

prob_blockD2 = zeros(1, length(dist_LEDD2));    
for index = 1:length(dist_LEDD2)
    if (dist_LEDD2(index) ~= 0)
        prob_blockD2(index) = interp1(dist_plotD, prob_finalD, dist_LEDD2(index));
    else
        prob_blockD2(index) = 0;
    end
end

if v == 1
prob_blockA2(548:553) = 0;
prob_blockB2(548:553) = 0;
prob_blockC2(548:553) = 0;
prob_blockD2(548:553) = 0;

elseif v == 1.5
prob_blockA2(653:667) = 0;
prob_blockB2(653:667) = 0;
prob_blockC2(653:667) = 0;
prob_blockD2(653:667) = 0;
end

prob_blockA = prob_blockA1 + prob_blockA2;
prob_blockB = prob_blockB1 + prob_blockB2;
prob_blockC = prob_blockC1 + prob_blockC2;
prob_blockD = prob_blockD1 + prob_blockD2;

%Power Calculation_________________________________________________________

theta =70;

I2 = 0.562; % Noise-bandwidth factor 
Rb = 115200; % Data rate (Bit per second)
Iamb = 7E-8; % Ambient light power (Ampere) %
R = 0.55; % Photodiode responsivity (A/W )%
q_c = 1.60E-19; % Electron charge (C)
% Amplifier bandwidth (Hz)%
Ba = 4.5E6;
% Amplifier noise density (Ampere/Hz^0.5)%
Iamf = 5e-12 ;
% semi-angle at half power
ml=-log10(2)/log10(cosd(theta)); %Lambertian order of emission
P_LED=20; %transmitted optical power by individual LED
nLED=60; % number of LED array nLED*nLED
P_total=nLED*nLED*P_LED; %Total transmitted power
Adet=10^-4; %detector physical area of a PD
Ts=1; %gain of an optical filter; ignore if no filter is used
index=1.5; %refractive index of a lens at a PD; ignore if no lens is used
FOV=70; %FOV of a receiver
G_Con=(index^2)/(sind(FOV).^2); %Gain of an optical concentrator; ignore if no lens is used

lx=5; ly=5; lz=3; %Room dimension
h=2.15; % dist b/w source and receiver plane

% [XT,YT]=meshgrid([lx/4 3*lx/4],[ly/4 3*ly/4]);
% Nx=lx*5; Ny=ly*5;
% x_coord = linspace(0,lx,Nx);
% y_coord = linspace(0,ly,Ny);
% [XR,YR] = meshgrid(x_coord,y_coord);
% D1 = sqrt((XR-XT(1,1)).^2+(YR-YT(1,1)).^2+h^2);
% D2 = sqrt((XR-XT(1,2)).^2+(YR-YT(1,2)).^2+h^2);
% D4 = sqrt((XR-XT(2,1)).^2+(YR-YT(2,1)).^2+h^2);
% D3 = sqrt((XR-XT(2,2)).^2+(YR-YT(2,2)).^2+h^2);

D1 = sqrt((p(1)-a)^2 + (q(1)-b)^2 + h^2);
D2 = sqrt((p(2)-a)^2 + (q(2)-b)^2 + h^2);
D3 = sqrt((p(3)-a)^2 + (q(3)-b)^2 + h^2);
D4 = sqrt((p(4)-a)^2 + (q(4)-b)^2 + h^2);

cosphi_A1=h./D1;
receiver_angle=acosd(cosphi_A1);

cosphi_A2=h./D2;
receiver_angle2=acosd(cosphi_A2);

cosphi_A3=h./D3;
receiver_angle3=acosd(cosphi_A3);

cosphi_A4=h./D4;
receiver_angle4=acosd(cosphi_A4);

H_A1=(ml+1)*Adet.*cosphi_A1.^(ml+1)./(2*pi.*D1.^2);
H_A2=(ml+1)*Adet.*cosphi_A2.^(ml+1)./(2*pi.*D2.^2);
H_A3=(ml+1)*Adet.*cosphi_A3.^(ml+1)./(2*pi.*D3.^2);
H_A4=(ml+1)*Adet.*cosphi_A4.^(ml+1)./(2*pi.*D4.^2);


H_A1_blockageA = H_A1.*(1-prob_blockA);
H_A1_blockageB = H_A2.*(1-prob_blockB);
H_A1_blockageC = H_A3.*(1-prob_blockC);
H_A1_blockageD = H_A4.*(1-prob_blockD);


P_rec_A1 = P_total.*H_A1_blockageA.*Ts.*G_Con;
P_rec_A2 = P_total.*H_A1_blockageB.*Ts.*G_Con;
P_rec_A3 = P_total.*H_A1_blockageC.*Ts.*G_Con;
P_rec_A4 = P_total.*H_A1_blockageD.*Ts.*G_Con;

P_rec_A1(abs(receiver_angle)>FOV)=0;
P_rec_A2(abs(receiver_angle2)>FOV)=0;
P_rec_A3(abs(receiver_angle3)>FOV)=0;
P_rec_A4(abs(receiver_angle4)>FOV)=0;
P_rec_total = P_rec_A1 + P_rec_A2 + P_rec_A3 + P_rec_A4;
P_rec_dBm=10*log10(P_rec_total);
Var_power = var(P_rec_dBm);

Bn = I2 * Rb; % Noise-bandwidth (Sec^-1)%
Pamb = Iamb / R; % Ambient light power (W) %
% Shot-noise variance ( Ampere^2 )%
omega_shot = 2 * q_c * R .* (P_rec_total + Pamb) * Bn; 
% Amplifier noise variance ( Ampere^2 )%
omega_amplifier = Iamf^2 * Ba; 
%Thermal noise variance
omega_thermal = (8*pi*295*112E-8*1E-3*.562*1E6*1.38E-23)+((16*pi^2*1.38E-23*295*1.5*(112E-8)^2*1E-8*.56281E12)/.03);
% Total noise variance ( Ampere^2 )%
omega_total = omega_amplifier + omega_shot+omega_thermal; 
% SNR %
SNR = (( R * P_rec_total ).^2)./ 10^-11;
SNRdB = 10*log10(SNR);

figure(2);
plot(time_block1, P_rec_dBm, 'linewidth', 1.5);
xlabel('Time (s)'); ylabel('Power (dBm)');
title('Received Power (dBm), Simulation time = 10000s, Pause time = 50s');


function [prob_block] = integrate(x,y,pause_prob, m_min, c_min, m_max, c_max, x_min, x_max)
    ymin = m_min*x + c_min;
    ymax = m_max*x + c_max;
%     display(ymin);
%     display(ymax);
    fxy(x,y) = (pause_prob + (1-pause_prob)*(-6/5^3*y^2 + 6/5^2*y)*(-6/5^3*x^2 + 6/5^2*x));
   
    dy = int(fxy, y);
    dy1 = subs(dy, y, ymin);
    dy2 = subs(dy, y, ymax);
  
    fy = dy2 - dy1;
    
    dydx(x) = fy;
    
    dx = int(dydx);

    dx1 = subs(dx, x, x_min);
    dx2 = subs(dx, x, x_max);
    
    prob_block = dx2-dx1;
    
%     display(prob_block);

end

