syms x y a b r d m c;

%Pause time = 10 seconds

blockages = 8;

if (blockages == 1)
    x1= [1.6907           0       1.377      2.3707      2.3707      2.6499      4.7983      4.7983           0     0.42535     0.42535     0.51962      0.5372      0.5372      2.2421      2.2421     0.95713           0    0.032177    0.032177      1.2982      3.7201      3.7201      3.3198      3.2939      3.2939           0     0.19746     0.19746           0      2.4745      2.4745      3.9823       4.938       4.938           5      4.6038      3.7241      3.7241      2.7105      2.0132      2.0132           5      4.8424      4.8424      1.9798      1.9798      2.0054       2.207       2.207           5      2.5693      2.5693           0        1.67        1.67     0.66075           0     0.27972     0.27972     0.96499      2.1726      2.1726       3.097       3.097      2.2986           0     0.12114     0.12114           0           5      4.3153      4.3153      1.9876           0     0.19291     0.19291     0.36281      2.7203      2.7203           5      4.1764      2.3996      2.3996     0.85644           0      1.1832      1.1832      1.2651      1.3263      1.3263           5      3.0113      3.0113      1.7555       1.288       1.288     0.84979     0.84979           0      1.4308      1.4308           0      2.4423      2.4423      2.5302       4.211       4.211           5       3.398      2.2171      2.2171];
    y1= [4.1617      4.6237           5      4.7285      4.7285           5      2.9101      2.9101      2.1454      2.0776      2.0776           5       4.455       4.455      2.1088      2.1088           0      1.5707      1.6235      1.6235           0      3.1059      3.1059           0     0.20146     0.20146      1.4975      1.5752      1.5752      1.6644      2.7823      2.7823           0      1.7634      1.7634      1.5247           0      3.3852      3.3852           0      2.3289      2.3289     0.13224    0.016354    0.016354      4.4598      4.4598           5     0.74224     0.74224      2.1208      3.3205      3.3205      3.9209       4.311       4.311           5      4.5489       4.358       4.358           5      3.8686      3.8686      1.2417      1.2417           0      3.5745      3.7629      3.7629      3.7842      4.6631      4.7835      4.7835           5      4.8151      4.7972      4.7972           5      2.1853      2.1853     0.57996           0      1.2513      1.2513           0     0.69445      1.6539      1.6539           5         2.5         2.5      3.4483      3.9616      3.9616           5      4.6134      4.6134      1.3995      1.3995      2.1968      3.5393      3.5393      2.2949      0.1707      0.1707           0      3.2656      3.2656       3.838           5      4.1434      4.1434];

elseif(blockages == 2)
    x1= [1.6907           0       1.377      2.3707      2.3707      2.6499      4.7983      4.7983           0     0.42535     0.42535     0.51962      0.5372      0.5372      2.2421      2.2421     0.95713           0    0.032177    0.032177      1.2982      3.7201      3.7201      3.3198      3.2939      3.2939           0     0.19746     0.19746           0      2.4745      2.4745      3.9823       4.938       4.938           5      4.6038      3.7241      3.7241      2.7105      2.0132      2.0132           5      4.8424      4.8424      1.9798      1.9798      2.0054       2.207       2.207           5      2.5693      2.5693           0        1.67        1.67     0.66075           0     0.27972     0.27972     0.96499      2.1726      2.1726       3.097       3.097      2.2986           0     0.12114     0.12114           0           5      4.3153      4.3153      1.9876           0     0.19291     0.19291     0.36281      2.7203      2.7203           5      4.1764      2.3996      2.3996     0.85644           0      1.1832      1.1832      1.2651      1.3263      1.3263           5      3.0113      3.0113      1.7555       1.288       1.288     0.84979     0.84979           0      1.4308      1.4308           0      2.4423      2.4423      2.5302       4.211       4.211           5       3.398      2.2171      2.2171];
    y1= [4.1617      4.6237           5      4.7285      4.7285           5      2.9101      2.9101      2.1454      2.0776      2.0776           5       4.455       4.455      2.1088      2.1088           0      1.5707      1.6235      1.6235           0      3.1059      3.1059           0     0.20146     0.20146      1.4975      1.5752      1.5752      1.6644      2.7823      2.7823           0      1.7634      1.7634      1.5247           0      3.3852      3.3852           0      2.3289      2.3289     0.13224    0.016354    0.016354      4.4598      4.4598           5     0.74224     0.74224      2.1208      3.3205      3.3205      3.9209       4.311       4.311           5      4.5489       4.358       4.358           5      3.8686      3.8686      1.2417      1.2417           0      3.5745      3.7629      3.7629      3.7842      4.6631      4.7835      4.7835           5      4.8151      4.7972      4.7972           5      2.1853      2.1853     0.57996           0      1.2513      1.2513           0     0.69445      1.6539      1.6539           5         2.5         2.5      3.4483      3.9616      3.9616           5      4.6134      4.6134      1.3995      1.3995      2.1968      3.5393      3.5393      2.2949      0.1707      0.1707           0      3.2656      3.2656       3.838           5      4.1434      4.1434];

    x2 = [3.2218           5      1.1827      1.1827           5      3.2686      3.2686       1.625           0     0.11954     0.11954           0      1.0424      1.0424           0    0.072989     0.39971     0.39971           0      2.7519      2.7519           0     0.24739     0.51536     0.51536      3.3494      4.9091      4.9091     0.74876     0.74876      1.1619      2.1457      2.1457           0      1.0625      1.0625           0      1.0331      1.0331     0.98478     0.98478           0      1.1037      2.9982      2.9982      4.8966      4.8966      3.1295      2.7782      2.7782      2.1297      2.1297      3.6204      4.5375      4.5375      3.9122      2.9603      2.9603      4.9987      4.9987           5      2.8245      2.7364      2.7364      2.8182           5      4.4756      4.4756           5           0     0.25158     0.25158     0.40592     0.51147     0.51147      1.7703      1.7703     0.39146     0.39146      1.2889      2.1409      2.1409     0.75318     0.40817     0.40817      3.6005      3.6005           5      2.7056      2.7056           5       4.337       4.337      3.2393      3.2393       1.662     0.65139     0.65139     0.34729     0.34729      0.5488      1.5579      1.5579      1.8312      2.1992      2.1992       2.061];
    y2 = [0.84619      1.3419      2.4061      2.4061      1.9848      1.7937      1.7937           0      1.7734      1.9039      1.9039       2.082      3.6351      3.6351     0.23787           0      1.0648      1.0648       1.147      1.7133      1.7133      4.7289           5      4.7063      4.7063           5      4.8384      4.8384      1.2499      1.2499           0      2.9761      2.9761      2.2143      1.8371      1.8371      2.4848      3.1145      3.1145     0.36788     0.36788     0.19442           0      0.3337      0.3337      2.2473      2.2473           0     0.44674     0.44674      2.3641      2.3641           5      3.3782      3.3782           5      2.5312      2.5312      1.8847      1.8847      1.8837           0     0.07625     0.07625           0      2.0344      2.5234      2.5234      2.5568      2.8745      2.8905      2.8905           5      3.5573      3.5573      1.0242      1.0242      4.0975      4.0975           5      4.1432      4.1432           0      1.0301      1.0301     0.96031     0.96031      1.6651      2.8205      2.8205     0.70004    0.087315    0.087315      2.6784      2.6784           0      1.7162      1.7162      4.5167      4.5167           5      2.5798      2.5798           5      1.7409      1.7409      1.0386];

elseif(blockages == 3)
    x1= [1.6907           0       1.377      2.3707      2.3707      2.6499      4.7983      4.7983           0     0.42535     0.42535     0.51962      0.5372      0.5372      2.2421      2.2421     0.95713           0    0.032177    0.032177      1.2982      3.7201      3.7201      3.3198      3.2939      3.2939           0     0.19746     0.19746           0      2.4745      2.4745      3.9823       4.938       4.938           5      4.6038      3.7241      3.7241      2.7105      2.0132      2.0132           5      4.8424      4.8424      1.9798      1.9798      2.0054       2.207       2.207           5      2.5693      2.5693           0        1.67        1.67     0.66075           0     0.27972     0.27972     0.96499      2.1726      2.1726       3.097       3.097      2.2986           0     0.12114     0.12114           0           5      4.3153      4.3153      1.9876           0     0.19291     0.19291     0.36281      2.7203      2.7203           5      4.1764      2.3996      2.3996     0.85644           0      1.1832      1.1832      1.2651      1.3263      1.3263           5      3.0113      3.0113      1.7555       1.288       1.288     0.84979     0.84979           0      1.4308      1.4308           0      2.4423      2.4423      2.5302       4.211       4.211           5       3.398      2.2171      2.2171];
    y1= [4.1617      4.6237           5      4.7285      4.7285           5      2.9101      2.9101      2.1454      2.0776      2.0776           5       4.455       4.455      2.1088      2.1088           0      1.5707      1.6235      1.6235           0      3.1059      3.1059           0     0.20146     0.20146      1.4975      1.5752      1.5752      1.6644      2.7823      2.7823           0      1.7634      1.7634      1.5247           0      3.3852      3.3852           0      2.3289      2.3289     0.13224    0.016354    0.016354      4.4598      4.4598           5     0.74224     0.74224      2.1208      3.3205      3.3205      3.9209       4.311       4.311           5      4.5489       4.358       4.358           5      3.8686      3.8686      1.2417      1.2417           0      3.5745      3.7629      3.7629      3.7842      4.6631      4.7835      4.7835           5      4.8151      4.7972      4.7972           5      2.1853      2.1853     0.57996           0      1.2513      1.2513           0     0.69445      1.6539      1.6539           5         2.5         2.5      3.4483      3.9616      3.9616           5      4.6134      4.6134      1.3995      1.3995      2.1968      3.5393      3.5393      2.2949      0.1707      0.1707           0      3.2656      3.2656       3.838           5      4.1434      4.1434];

    x2 = [3.2218           5      1.1827      1.1827           5      3.2686      3.2686       1.625           0     0.11954     0.11954           0      1.0424      1.0424           0    0.072989     0.39971     0.39971           0      2.7519      2.7519           0     0.24739     0.51536     0.51536      3.3494      4.9091      4.9091     0.74876     0.74876      1.1619      2.1457      2.1457           0      1.0625      1.0625           0      1.0331      1.0331     0.98478     0.98478           0      1.1037      2.9982      2.9982      4.8966      4.8966      3.1295      2.7782      2.7782      2.1297      2.1297      3.6204      4.5375      4.5375      3.9122      2.9603      2.9603      4.9987      4.9987           5      2.8245      2.7364      2.7364      2.8182           5      4.4756      4.4756           5           0     0.25158     0.25158     0.40592     0.51147     0.51147      1.7703      1.7703     0.39146     0.39146      1.2889      2.1409      2.1409     0.75318     0.40817     0.40817      3.6005      3.6005           5      2.7056      2.7056           5       4.337       4.337      3.2393      3.2393       1.662     0.65139     0.65139     0.34729     0.34729      0.5488      1.5579      1.5579      1.8312      2.1992      2.1992       2.061];
    y2 = [0.84619      1.3419      2.4061      2.4061      1.9848      1.7937      1.7937           0      1.7734      1.9039      1.9039       2.082      3.6351      3.6351     0.23787           0      1.0648      1.0648       1.147      1.7133      1.7133      4.7289           5      4.7063      4.7063           5      4.8384      4.8384      1.2499      1.2499           0      2.9761      2.9761      2.2143      1.8371      1.8371      2.4848      3.1145      3.1145     0.36788     0.36788     0.19442           0      0.3337      0.3337      2.2473      2.2473           0     0.44674     0.44674      2.3641      2.3641           5      3.3782      3.3782           5      2.5312      2.5312      1.8847      1.8847      1.8837           0     0.07625     0.07625           0      2.0344      2.5234      2.5234      2.5568      2.8745      2.8905      2.8905           5      3.5573      3.5573      1.0242      1.0242      4.0975      4.0975           5      4.1432      4.1432           0      1.0301      1.0301     0.96031     0.96031      1.6651      2.8205      2.8205     0.70004    0.087315    0.087315      2.6784      2.6784           0      1.7162      1.7162      4.5167      4.5167           5      2.5798      2.5798           5      1.7409      1.7409      1.0386];

    x3 = [2.1838       1.114     0.27792     0.27792     0.10614           0     0.31549     0.31549      2.9203      2.9203      3.4634      3.5109      3.5109      1.2922      1.2922           5      4.4375      4.4375      4.2223      1.5603      1.5603     0.19121     0.19121           0      1.7993      1.7993           0     0.86044     0.86044     0.22834           0      4.8375      4.8375      2.8564      2.8564      4.8021      4.8021      4.8308      4.9344      4.9344     0.14538     0.14538     0.55367      0.6198      0.6198           0      3.9258      3.9258      1.7582     0.76005     0.76005    0.049162           0     0.87731     0.87731     0.48561     0.40819     0.40819     0.38735     0.25305     0.25305      3.0772      3.0772           0      1.0787      1.0787           5      4.2618      4.2618           0     0.26545     0.26545           0     0.80688     0.80688      2.2767      2.2767     0.30671     0.30671           0     0.28708     0.28708      4.2388           5      4.3632      4.3632           5       4.487       4.487      4.3293      3.5682      3.5682      4.7796           5      2.8677      2.8677      0.1572           0      1.2735      1.2735           0     0.77879     0.77879           0      4.1585      4.1585      4.0703];
    y3 = [2.8613           5      3.3285      3.3285           5      3.9673     0.89746     0.89746     0.84378     0.84378           5      4.6364      4.6364     0.96083     0.96083      0.3792     0.29096     0.29096           0      3.5984      3.5984      1.2378      1.2378      1.2901      1.7822      1.7822      3.8933      4.9028      4.9028           5      4.9649      4.2207      4.2207      3.2689      3.2689      3.8026      3.8026           5     0.68352     0.68352      3.0106      3.0106           0     0.48766     0.48766     0.71375      2.1458      2.1458           5      3.6856      3.6856           5      4.9091       3.287       3.287           5      4.6614      4.6614           5       2.818       2.818      3.2165      3.2165      4.3264      4.7154      4.7154      3.2451      2.9683      2.9683      2.0903      2.0356      2.0356      2.6937      4.6941      4.6941      3.2636      3.2636      4.1422      4.1422      3.0096      1.9494      1.9494           0     0.37551     0.68964     0.68964      2.9044      4.6887      4.6887           5      3.4976      3.4976           5      4.7266      2.0822      2.0822           0     0.12076      1.0991      1.0991      2.6878      3.6593      3.6593      3.5022      2.6631      2.6631      2.9882];

 elseif(blockages == 4)
    x1= [1.6907           0       1.377      2.3707      2.3707      2.6499      4.7983      4.7983           0     0.42535     0.42535     0.51962      0.5372      0.5372      2.2421      2.2421     0.95713           0    0.032177    0.032177      1.2982      3.7201      3.7201      3.3198      3.2939      3.2939           0     0.19746     0.19746           0      2.4745      2.4745      3.9823       4.938       4.938           5      4.6038      3.7241      3.7241      2.7105      2.0132      2.0132           5      4.8424      4.8424      1.9798      1.9798      2.0054       2.207       2.207           5      2.5693      2.5693           0        1.67        1.67     0.66075           0     0.27972     0.27972     0.96499      2.1726      2.1726       3.097       3.097      2.2986           0     0.12114     0.12114           0           5      4.3153      4.3153      1.9876           0     0.19291     0.19291     0.36281      2.7203      2.7203           5      4.1764      2.3996      2.3996     0.85644           0      1.1832      1.1832      1.2651      1.3263      1.3263           5      3.0113      3.0113      1.7555       1.288       1.288     0.84979     0.84979           0      1.4308      1.4308           0      2.4423      2.4423      2.5302       4.211       4.211           5       3.398      2.2171      2.2171];
    y1= [4.1617      4.6237           5      4.7285      4.7285           5      2.9101      2.9101      2.1454      2.0776      2.0776           5       4.455       4.455      2.1088      2.1088           0      1.5707      1.6235      1.6235           0      3.1059      3.1059           0     0.20146     0.20146      1.4975      1.5752      1.5752      1.6644      2.7823      2.7823           0      1.7634      1.7634      1.5247           0      3.3852      3.3852           0      2.3289      2.3289     0.13224    0.016354    0.016354      4.4598      4.4598           5     0.74224     0.74224      2.1208      3.3205      3.3205      3.9209       4.311       4.311           5      4.5489       4.358       4.358           5      3.8686      3.8686      1.2417      1.2417           0      3.5745      3.7629      3.7629      3.7842      4.6631      4.7835      4.7835           5      4.8151      4.7972      4.7972           5      2.1853      2.1853     0.57996           0      1.2513      1.2513           0     0.69445      1.6539      1.6539           5         2.5         2.5      3.4483      3.9616      3.9616           5      4.6134      4.6134      1.3995      1.3995      2.1968      3.5393      3.5393      2.2949      0.1707      0.1707           0      3.2656      3.2656       3.838           5      4.1434      4.1434];

    x2 = [3.2218           5      1.1827      1.1827           5      3.2686      3.2686       1.625           0     0.11954     0.11954           0      1.0424      1.0424           0    0.072989     0.39971     0.39971           0      2.7519      2.7519           0     0.24739     0.51536     0.51536      3.3494      4.9091      4.9091     0.74876     0.74876      1.1619      2.1457      2.1457           0      1.0625      1.0625           0      1.0331      1.0331     0.98478     0.98478           0      1.1037      2.9982      2.9982      4.8966      4.8966      3.1295      2.7782      2.7782      2.1297      2.1297      3.6204      4.5375      4.5375      3.9122      2.9603      2.9603      4.9987      4.9987           5      2.8245      2.7364      2.7364      2.8182           5      4.4756      4.4756           5           0     0.25158     0.25158     0.40592     0.51147     0.51147      1.7703      1.7703     0.39146     0.39146      1.2889      2.1409      2.1409     0.75318     0.40817     0.40817      3.6005      3.6005           5      2.7056      2.7056           5       4.337       4.337      3.2393      3.2393       1.662     0.65139     0.65139     0.34729     0.34729      0.5488      1.5579      1.5579      1.8312      2.1992      2.1992       2.061];
    y2 = [0.84619      1.3419      2.4061      2.4061      1.9848      1.7937      1.7937           0      1.7734      1.9039      1.9039       2.082      3.6351      3.6351     0.23787           0      1.0648      1.0648       1.147      1.7133      1.7133      4.7289           5      4.7063      4.7063           5      4.8384      4.8384      1.2499      1.2499           0      2.9761      2.9761      2.2143      1.8371      1.8371      2.4848      3.1145      3.1145     0.36788     0.36788     0.19442           0      0.3337      0.3337      2.2473      2.2473           0     0.44674     0.44674      2.3641      2.3641           5      3.3782      3.3782           5      2.5312      2.5312      1.8847      1.8847      1.8837           0     0.07625     0.07625           0      2.0344      2.5234      2.5234      2.5568      2.8745      2.8905      2.8905           5      3.5573      3.5573      1.0242      1.0242      4.0975      4.0975           5      4.1432      4.1432           0      1.0301      1.0301     0.96031     0.96031      1.6651      2.8205      2.8205     0.70004    0.087315    0.087315      2.6784      2.6784           0      1.7162      1.7162      4.5167      4.5167           5      2.5798      2.5798           5      1.7409      1.7409      1.0386];

    x3 = [2.1838       1.114     0.27792     0.27792     0.10614           0     0.31549     0.31549      2.9203      2.9203      3.4634      3.5109      3.5109      1.2922      1.2922           5      4.4375      4.4375      4.2223      1.5603      1.5603     0.19121     0.19121           0      1.7993      1.7993           0     0.86044     0.86044     0.22834           0      4.8375      4.8375      2.8564      2.8564      4.8021      4.8021      4.8308      4.9344      4.9344     0.14538     0.14538     0.55367      0.6198      0.6198           0      3.9258      3.9258      1.7582     0.76005     0.76005    0.049162           0     0.87731     0.87731     0.48561     0.40819     0.40819     0.38735     0.25305     0.25305      3.0772      3.0772           0      1.0787      1.0787           5      4.2618      4.2618           0     0.26545     0.26545           0     0.80688     0.80688      2.2767      2.2767     0.30671     0.30671           0     0.28708     0.28708      4.2388           5      4.3632      4.3632           5       4.487       4.487      4.3293      3.5682      3.5682      4.7796           5      2.8677      2.8677      0.1572           0      1.2735      1.2735           0     0.77879     0.77879           0      4.1585      4.1585      4.0703];
    y3 = [2.8613           5      3.3285      3.3285           5      3.9673     0.89746     0.89746     0.84378     0.84378           5      4.6364      4.6364     0.96083     0.96083      0.3792     0.29096     0.29096           0      3.5984      3.5984      1.2378      1.2378      1.2901      1.7822      1.7822      3.8933      4.9028      4.9028           5      4.9649      4.2207      4.2207      3.2689      3.2689      3.8026      3.8026           5     0.68352     0.68352      3.0106      3.0106           0     0.48766     0.48766     0.71375      2.1458      2.1458           5      3.6856      3.6856           5      4.9091       3.287       3.287           5      4.6614      4.6614           5       2.818       2.818      3.2165      3.2165      4.3264      4.7154      4.7154      3.2451      2.9683      2.9683      2.0903      2.0356      2.0356      2.6937      4.6941      4.6941      3.2636      3.2636      4.1422      4.1422      3.0096      1.9494      1.9494           0     0.37551     0.68964     0.68964      2.9044      4.6887      4.6887           5      3.4976      3.4976           5      4.7266      2.0822      2.0822           0     0.12076      1.0991      1.0991      2.6878      3.6593      3.6593      3.5022      2.6631      2.6631      2.9882];

    x4 = [3.8609      2.3328      2.2156      2.2156      3.1569      3.3565      3.3565           0      1.1559      1.1559      4.1343      4.1343           5      4.6368      4.1953      4.1953           5      4.4868      2.2418      2.2418      4.2591      4.2591       4.289        4.48        4.48      1.4275      1.4275           5      3.7927      3.7927      4.2144      4.9281      4.9281           5      3.2469      3.2469      3.2489        3.27        3.27           5      4.8974      2.9453      2.9453           0      1.2465      1.6423      1.6423      1.7349      3.1817      3.1817           5     0.84916     0.84916     0.79757           0      1.7108      1.7108      1.1906     0.75222     0.75222       2.222      3.3652      3.3652      1.6375      1.3894      1.3894      1.2866     0.53283     0.53283           0     0.85478     0.85478           0     0.53859      0.5639      0.5639    0.088077           0      4.8861      4.8861      3.9395      3.9395      3.1635      2.8137      2.8137       4.173       4.173      3.7384      1.6091      1.6091      1.4235      1.3279      1.3279           5      2.9569      2.9569     0.96554     0.96554           0     0.76435     0.76435     0.76461     0.76595     0.76595      1.4638      1.9615      1.9615      4.3961];
    y4 = [0.1065           5      4.6245      4.6245           0     0.98041     0.98041      1.6959      1.9422      1.9422      3.7062      3.7062      1.0954           0      1.3316      1.3316      0.5185           0      2.2684      2.2684      4.6637      4.6637           5      2.8532      2.8532      1.2678      1.2678     0.95061     0.84341     0.84341           0      1.4275      1.4275      1.5565      4.7025      4.7025           5      1.7748      1.7748    0.099343           0      1.8906      1.8906      4.0754           5      4.7064      4.7064           5     0.41072     0.41072     0.30296    0.056954    0.056954           0     0.88045       2.769       2.769           0       2.334       2.334           0      1.8153      1.8153           5      4.5427      4.5427           5      1.6498      1.6498      1.0362    0.051875    0.051875      3.0874           5      4.9101      4.9101           5      4.9834      4.0605      4.0605      1.9656      1.9656           5      3.6324      3.6324     0.71387     0.71387           0      3.4968      3.4968           5      4.2257      4.2257      3.4393      3.0018      3.0018      3.2372      3.2372      1.7352     0.54616     0.54616           0      2.8483      2.8483           0      2.0316      2.0316       3.702];

elseif (blockages == 5)
    x1= [1.6907           0       1.377      2.3707      2.3707      2.6499      4.7983      4.7983           0     0.42535     0.42535     0.51962      0.5372      0.5372      2.2421      2.2421     0.95713           0    0.032177    0.032177      1.2982      3.7201      3.7201      3.3198      3.2939      3.2939           0     0.19746     0.19746           0      2.4745      2.4745      3.9823       4.938       4.938           5      4.6038      3.7241      3.7241      2.7105      2.0132      2.0132           5      4.8424      4.8424      1.9798      1.9798      2.0054       2.207       2.207           5      2.5693      2.5693           0        1.67        1.67     0.66075           0     0.27972     0.27972     0.96499      2.1726      2.1726       3.097       3.097      2.2986           0     0.12114     0.12114           0           5      4.3153      4.3153      1.9876           0     0.19291     0.19291     0.36281      2.7203      2.7203           5      4.1764      2.3996      2.3996     0.85644           0      1.1832      1.1832      1.2651      1.3263      1.3263           5      3.0113      3.0113      1.7555       1.288       1.288     0.84979     0.84979           0      1.4308      1.4308           0      2.4423      2.4423      2.5302       4.211       4.211           5       3.398      2.2171      2.2171];
    y1= [4.1617      4.6237           5      4.7285      4.7285           5      2.9101      2.9101      2.1454      2.0776      2.0776           5       4.455       4.455      2.1088      2.1088           0      1.5707      1.6235      1.6235           0      3.1059      3.1059           0     0.20146     0.20146      1.4975      1.5752      1.5752      1.6644      2.7823      2.7823           0      1.7634      1.7634      1.5247           0      3.3852      3.3852           0      2.3289      2.3289     0.13224    0.016354    0.016354      4.4598      4.4598           5     0.74224     0.74224      2.1208      3.3205      3.3205      3.9209       4.311       4.311           5      4.5489       4.358       4.358           5      3.8686      3.8686      1.2417      1.2417           0      3.5745      3.7629      3.7629      3.7842      4.6631      4.7835      4.7835           5      4.8151      4.7972      4.7972           5      2.1853      2.1853     0.57996           0      1.2513      1.2513           0     0.69445      1.6539      1.6539           5         2.5         2.5      3.4483      3.9616      3.9616           5      4.6134      4.6134      1.3995      1.3995      2.1968      3.5393      3.5393      2.2949      0.1707      0.1707           0      3.2656      3.2656       3.838           5      4.1434      4.1434];

    x2 = [3.2218           5      1.1827      1.1827           5      3.2686      3.2686       1.625           0     0.11954     0.11954           0      1.0424      1.0424           0    0.072989     0.39971     0.39971           0      2.7519      2.7519           0     0.24739     0.51536     0.51536      3.3494      4.9091      4.9091     0.74876     0.74876      1.1619      2.1457      2.1457           0      1.0625      1.0625           0      1.0331      1.0331     0.98478     0.98478           0      1.1037      2.9982      2.9982      4.8966      4.8966      3.1295      2.7782      2.7782      2.1297      2.1297      3.6204      4.5375      4.5375      3.9122      2.9603      2.9603      4.9987      4.9987           5      2.8245      2.7364      2.7364      2.8182           5      4.4756      4.4756           5           0     0.25158     0.25158     0.40592     0.51147     0.51147      1.7703      1.7703     0.39146     0.39146      1.2889      2.1409      2.1409     0.75318     0.40817     0.40817      3.6005      3.6005           5      2.7056      2.7056           5       4.337       4.337      3.2393      3.2393       1.662     0.65139     0.65139     0.34729     0.34729      0.5488      1.5579      1.5579      1.8312      2.1992      2.1992       2.061];
    y2 = [0.84619      1.3419      2.4061      2.4061      1.9848      1.7937      1.7937           0      1.7734      1.9039      1.9039       2.082      3.6351      3.6351     0.23787           0      1.0648      1.0648       1.147      1.7133      1.7133      4.7289           5      4.7063      4.7063           5      4.8384      4.8384      1.2499      1.2499           0      2.9761      2.9761      2.2143      1.8371      1.8371      2.4848      3.1145      3.1145     0.36788     0.36788     0.19442           0      0.3337      0.3337      2.2473      2.2473           0     0.44674     0.44674      2.3641      2.3641           5      3.3782      3.3782           5      2.5312      2.5312      1.8847      1.8847      1.8837           0     0.07625     0.07625           0      2.0344      2.5234      2.5234      2.5568      2.8745      2.8905      2.8905           5      3.5573      3.5573      1.0242      1.0242      4.0975      4.0975           5      4.1432      4.1432           0      1.0301      1.0301     0.96031     0.96031      1.6651      2.8205      2.8205     0.70004    0.087315    0.087315      2.6784      2.6784           0      1.7162      1.7162      4.5167      4.5167           5      2.5798      2.5798           5      1.7409      1.7409      1.0386];

    x3 = [2.1838       1.114     0.27792     0.27792     0.10614           0     0.31549     0.31549      2.9203      2.9203      3.4634      3.5109      3.5109      1.2922      1.2922           5      4.4375      4.4375      4.2223      1.5603      1.5603     0.19121     0.19121           0      1.7993      1.7993           0     0.86044     0.86044     0.22834           0      4.8375      4.8375      2.8564      2.8564      4.8021      4.8021      4.8308      4.9344      4.9344     0.14538     0.14538     0.55367      0.6198      0.6198           0      3.9258      3.9258      1.7582     0.76005     0.76005    0.049162           0     0.87731     0.87731     0.48561     0.40819     0.40819     0.38735     0.25305     0.25305      3.0772      3.0772           0      1.0787      1.0787           5      4.2618      4.2618           0     0.26545     0.26545           0     0.80688     0.80688      2.2767      2.2767     0.30671     0.30671           0     0.28708     0.28708      4.2388           5      4.3632      4.3632           5       4.487       4.487      4.3293      3.5682      3.5682      4.7796           5      2.8677      2.8677      0.1572           0      1.2735      1.2735           0     0.77879     0.77879           0      4.1585      4.1585      4.0703];
    y3 = [2.8613           5      3.3285      3.3285           5      3.9673     0.89746     0.89746     0.84378     0.84378           5      4.6364      4.6364     0.96083     0.96083      0.3792     0.29096     0.29096           0      3.5984      3.5984      1.2378      1.2378      1.2901      1.7822      1.7822      3.8933      4.9028      4.9028           5      4.9649      4.2207      4.2207      3.2689      3.2689      3.8026      3.8026           5     0.68352     0.68352      3.0106      3.0106           0     0.48766     0.48766     0.71375      2.1458      2.1458           5      3.6856      3.6856           5      4.9091       3.287       3.287           5      4.6614      4.6614           5       2.818       2.818      3.2165      3.2165      4.3264      4.7154      4.7154      3.2451      2.9683      2.9683      2.0903      2.0356      2.0356      2.6937      4.6941      4.6941      3.2636      3.2636      4.1422      4.1422      3.0096      1.9494      1.9494           0     0.37551     0.68964     0.68964      2.9044      4.6887      4.6887           5      3.4976      3.4976           5      4.7266      2.0822      2.0822           0     0.12076      1.0991      1.0991      2.6878      3.6593      3.6593      3.5022      2.6631      2.6631      2.9882];

    x4 = [3.8609      2.3328      2.2156      2.2156      3.1569      3.3565      3.3565           0      1.1559      1.1559      4.1343      4.1343           5      4.6368      4.1953      4.1953           5      4.4868      2.2418      2.2418      4.2591      4.2591       4.289        4.48        4.48      1.4275      1.4275           5      3.7927      3.7927      4.2144      4.9281      4.9281           5      3.2469      3.2469      3.2489        3.27        3.27           5      4.8974      2.9453      2.9453           0      1.2465      1.6423      1.6423      1.7349      3.1817      3.1817           5     0.84916     0.84916     0.79757           0      1.7108      1.7108      1.1906     0.75222     0.75222       2.222      3.3652      3.3652      1.6375      1.3894      1.3894      1.2866     0.53283     0.53283           0     0.85478     0.85478           0     0.53859      0.5639      0.5639    0.088077           0      4.8861      4.8861      3.9395      3.9395      3.1635      2.8137      2.8137       4.173       4.173      3.7384      1.6091      1.6091      1.4235      1.3279      1.3279           5      2.9569      2.9569     0.96554     0.96554           0     0.76435     0.76435     0.76461     0.76595     0.76595      1.4638      1.9615      1.9615      4.3961];
    y4 = [0.1065           5      4.6245      4.6245           0     0.98041     0.98041      1.6959      1.9422      1.9422      3.7062      3.7062      1.0954           0      1.3316      1.3316      0.5185           0      2.2684      2.2684      4.6637      4.6637           5      2.8532      2.8532      1.2678      1.2678     0.95061     0.84341     0.84341           0      1.4275      1.4275      1.5565      4.7025      4.7025           5      1.7748      1.7748    0.099343           0      1.8906      1.8906      4.0754           5      4.7064      4.7064           5     0.41072     0.41072     0.30296    0.056954    0.056954           0     0.88045       2.769       2.769           0       2.334       2.334           0      1.8153      1.8153           5      4.5427      4.5427           5      1.6498      1.6498      1.0362    0.051875    0.051875      3.0874           5      4.9101      4.9101           5      4.9834      4.0605      4.0605      1.9656      1.9656           5      3.6324      3.6324     0.71387     0.71387           0      3.4968      3.4968           5      4.2257      4.2257      3.4393      3.0018      3.0018      3.2372      3.2372      1.7352     0.54616     0.54616           0      2.8483      2.8483           0      2.0316      2.0316       3.702];

    x5 = [0.73984           0    0.089287     0.63136     0.63136      4.0204      4.2712      4.2712           5       2.702       2.702      4.5313      4.5313      2.6815      2.6815           5       3.982       3.982           5      1.5811      1.5811      3.9489      3.9489           5      3.5159      3.5159      3.2859      1.4026      1.4026     0.25112     0.25112      2.0988      2.0988      1.9773      1.9773           0      1.7823      1.7823      1.7846      1.8744      1.8765      1.8765           5      3.9286      3.9286           5     0.99445     0.99445      4.7399      4.7399           5      3.0289      3.0289     0.97294     0.97294      2.9479           5      4.3369      4.3369     0.17775     0.17775     0.37793     0.37793      1.2774      1.2774           0      2.8965      2.8965      4.3438      4.9947      4.9947           5       1.428       1.428       1.164           0     0.46514     0.46514      4.2938      4.2938      3.7872      1.6451      1.6451      3.7522           5      2.7538      2.7538      4.3838      4.3949      4.3949      4.5044           5      1.2603      1.2603           0     0.16708     0.16708           0      2.5442      2.5442      2.9857      2.9857      2.3151];
    y5 = [3.6646      4.8562           5      4.1269      4.1269           0     0.30544     0.30544     0.81045      2.4028      2.4028     0.53592     0.53592      3.5674      3.5674      1.3254     0.34103     0.34103      1.1423      3.8335      3.8335     0.51787     0.51787      2.2884      4.7884      4.7884           5      3.2674      3.2674      1.3555      1.3555      2.8345      2.8345     0.54239     0.54239      0.3227     0.12466     0.12466           0           5      4.8821      4.8821      2.7523      2.0217      2.0217      2.6001      4.7622      4.7622      1.8058      1.8058      1.8445      2.1382      2.1382      4.0542      4.0542           5      4.0172      3.6996      3.6996       1.935       1.935      4.5697      4.5697      1.9711      1.9711      2.4877      3.6593      3.6593           0      1.6457      1.6457      1.6436     0.23371     0.23371           0      1.0306      1.4424      1.4424    0.071941    0.071941           0     0.30419     0.30419           0     0.18015     0.50442     0.50442           5      4.9693      4.9693           5      4.8609      3.8117      3.8117        2.55      2.3827      2.3827      2.4967      4.2316      4.2316      1.4959      1.4959      2.8601];
elseif (blockages == 6)
    %Pause time = 100, #Blockages = 2
    x1 = [3.6355      4.8492      4.8492      3.7642      2.5262      2.5262           0     0.41721     0.41721           0       3.546       3.546      3.7951      4.4209      4.4209           0      1.0771      1.0771           0      3.8258      3.8258           5     0.74374     0.74374           0       1.875       1.875      0.4239           0      2.7811      2.7811];
    y1 = [4.6837      1.7378      1.7378           0      1.9831      1.9831       2.073      2.0878      2.0878      1.9411     0.69358     0.69358           0       1.743       1.743      2.0688      2.1482      2.1482      2.3535       3.083       3.083      2.7612      1.5947      1.5947      2.2784      4.0022      4.0022           5      4.7085      2.7961      2.7961];

    x2 = [3.9614      3.4444      3.2252      3.2252      1.8326     0.24986     0.24986      4.1803      4.1803           5      4.4635      4.4635      2.3821      1.0134      1.0134     0.49149           0      2.3819      2.3819      1.0167     0.24579     0.24579     0.88735      1.0394      1.0394           0     0.14175      0.7166      0.7166      2.7867      2.7867];
    y2 = [0.95415           5      3.2844      3.2844           5        3.05        3.05      2.7665      2.7665      1.5403     0.73775     0.73775           0     0.48512     0.48512           0      0.4568      2.6706      2.6706           5      3.6846      3.6846           0     0.87301     0.87301     0.10477           0      0.4249      0.4249      2.3394      2.3394];
 
elseif (blockages == 7)
x1 =  [1.3672      1.2444      1.0549      1.0549           5      3.5215      3.5215      1.0667    0.037787    0.037787           0      1.0736      1.0736      3.3019      3.3019      2.3937      2.3937           0     0.35066     0.35066           5      4.8371      4.8371           5      4.6482      4.6482           5      4.6749      4.5074      4.5074           5     0.64192     0.64192           0      4.9605      4.9605      4.3145      4.2233      4.2233      4.8183           5      1.1032      1.1032      3.0907      4.9328      4.9328      3.1515      3.1515      1.7008      1.7008           0      2.2849      2.5379      2.5379           5      2.7385      2.7385      4.0052           5      4.1021      4.1021      3.3866      2.8377      2.8377           0     0.57301     0.57301           5      4.6724      4.6724           5      4.3449      3.2883      3.2883           5      2.1689      2.1689           5      3.6424      2.1084      2.1084      1.5133           0     0.57216     0.57216           0      0.5407     0.80672     0.80672           5      3.6134      3.6134           5      4.7299      4.6921      4.6921       4.778           5      1.8015      1.8015      1.7078      1.6822      1.6822           0      2.1686      2.1686      3.0268           5       3.553       3.553      2.8265      2.2962      2.2962           0     0.59211     0.59211       4.738       4.738           5      4.8331      3.8083      3.8083      3.6457      3.4678      3.4678           5      4.6782      3.8997      3.8997           0     0.91289     0.91289     0.15159     0.15159       2.549       2.549     0.51876           0     0.88116     0.88116       2.931       2.931      3.8593      4.9163      4.9163      4.7646        4.75        4.75      3.0038      2.8317      2.8317      2.1355      2.1355      2.1134      2.1075      2.1075      1.8752      1.5293      1.5293      3.3126      4.8142      4.8142      4.0189      4.0189           5      4.9631      3.9554      3.9554           5      3.3222      3.3222           5      3.5105      3.5105      1.2963      1.2963      3.0914      3.0914      2.3143      1.7362      1.7362           5      3.7567      3.7567           0      0.6003      0.6003           5      4.3163      4.3163      2.8614       2.795       2.795     0.43505     0.34284     0.34284     0.23434           0     0.99339     0.99339      2.7118      2.7118           0     0.26272     0.26272      1.7069       2.996       2.996      2.8785     0.97731     0.97731           0      1.4276      1.4276           0      1.9257      1.9257      1.8877     0.75052];
y1 = [3.7389           5      3.0533      3.0533      1.6213      1.0847      1.0847           0     0.45459     0.45459     0.58126      4.1801      4.1801      3.0512      3.0512      1.1189      1.1189      1.8626      1.9716      1.9716     0.16527     0.10199     0.10199      1.0585      3.1244      3.1244      1.5005           0     0.77323     0.77323      1.1292      4.2787      4.2787      4.1316      2.9949      2.9949           0     0.42295     0.42295           0     0.12912       2.899       2.899           5      3.0526      3.0526      4.1633      4.1633      1.8861      1.8861      1.0813           0     0.11971     0.11971      1.6517      3.0589      3.0589           5      3.4755      2.0996      2.0996           5       2.775       2.775        2.85      2.8652      2.8652      1.1183     0.98901     0.98901     0.65931           0      1.0635      1.0635      2.1235      3.8769      3.8769       4.636           5      4.5887      4.5887           5      3.9541      3.5587      3.5587      4.2997           5      4.6555      4.6555      4.2457      4.1102      4.1102     0.67008           0    0.093779    0.093779           0     0.24225      3.7332      3.7332           0      1.0202      1.0202      2.4254      4.2369      4.2369           5      3.2456      1.9591      1.9591           0        1.43        1.43     0.78748      0.6218      0.6218      4.2132      4.2132      4.6939           5      3.1196      3.1196           5      2.9416      2.9416     0.51053           0      1.2353      1.2353      3.7099      4.2892      4.2892      1.8967      1.8967      3.7014      3.7014           5      4.6682      4.1046      4.1046      2.8968      2.8968           5       2.605       2.605           5      4.7697      4.7697           0     0.47002     0.47002      4.0102      4.0102           0      1.0767      1.0767           0      1.6037      1.6037           0      1.3503      1.3503      3.2493      3.2493      4.9365           5      3.2672      3.2672      2.1338     0.31339     0.31339      2.6806      4.7821      4.7821      3.3142      3.3142      2.4004      2.4004           0      1.7859      1.7859      2.9432      3.3841      3.3841      2.9448      2.8746      2.8746      3.6141       3.729       3.729           0     0.17024     0.17024           5      4.8113      4.8113           5      4.5924      2.8646      2.8646      4.2834      4.2834      4.7724      4.8198      4.8198           5      4.8391      4.8391           5      2.3981      2.3981      2.1432      1.7708      1.7708      1.0415    0.057631    0.057631           0      1.7236];
   
x2 = [3.7988           5      3.6982      3.6982           5      1.0355      1.0355           0       1.826       3.532       3.532           5      1.9467      1.9467      2.9061      3.0881      3.0881      2.6164           0     0.43982     0.43982           0     0.91848      0.9554      0.9554           5      4.1537      4.1537      4.2228           5      4.0596      4.0596      4.1554      4.8661      4.8661           5           0     0.63813     0.63813      2.4224      2.4224           5      4.0591      3.8035      3.8035      3.9407           5      3.7391      3.7391           5      3.0135      3.0135      3.1358      4.5268      4.5268           5      4.2039      4.1782      4.1782      1.8545      1.8545      2.7955      2.7955      4.5946      4.5946      3.2312      3.2312           0      1.0195      1.0195      1.1675      1.2887      1.2887      2.9042      2.9042     0.98698           0      2.2023      2.2023           0      1.9794      1.9794      3.7125      4.2806      4.2806      2.0046      2.0046      2.3764      2.7052      2.7052      3.0069      4.3764      4.3764           5       4.836     0.84836     0.84836           5        4.36        4.36      4.6206      4.9909      4.9909           5      3.3802      3.3802      3.4127      3.4843      3.4843      4.3519      4.6498      4.6498           5      4.0994      4.0994      2.7742     0.60186     0.60186           0     0.76399     0.76399     0.52994     0.32103     0.32103     0.78412      1.2349      1.2349      1.0668     0.76602     0.76602           0      2.8803      2.8803           5      4.6703      4.6703      3.6419      2.8915      2.8915           5      2.2788      2.2788           5      4.3895      4.3895     0.15239     0.15239      3.2127      3.2127      2.4726      2.4726      1.7319     0.99746     0.99746           0      3.3384      4.3635      4.3635      4.3123      3.8986      3.8986      1.6966     0.36122     0.36122     0.94595      2.5517      2.5517      2.8045         2.9         2.9      3.2834           5      4.7022      4.7022           5     0.51759     0.51759      2.8167      2.9161      2.9161           0     0.38298     0.38298           0      1.1695      1.1695      1.6886           5      4.8516      4.8516           5      2.5777      2.5777      3.5344      3.5527      3.5527      3.5617      4.3835      4.3835      3.2083      2.7516      2.7516      2.4075      2.4075           0     0.98294     0.98294       3.177       3.177           0      1.2242      1.2242      2.6038      3.7414      3.7414           5      3.8981      3.8981];
y2 = [3.075       2.723      2.3416      2.3416      2.9225      4.6917      4.6917      4.8033           5      4.8162      4.8162      3.9822      2.2475      2.2475           5      4.4779      4.4779           5      2.1042      1.6174      1.6174      1.0937           0    0.043957    0.043957     0.15678     0.18039     0.18039           0      2.0307      4.4876      4.4876           5       1.196       1.196      1.2098      1.7242      1.7898      1.7898      3.4355      3.4355     0.91875           0     0.24953     0.24953           0      1.9259      4.2184      4.2184       2.686     0.27163     0.27163           0      3.0899      3.0899       1.938           0    0.062736    0.062736      2.9231      2.9231     0.37463     0.37463      2.0043      2.0043      4.8429      4.8429      2.9424      2.3428      2.3428           0      1.9176      1.9176      0.7056      0.7056           0     0.36323      1.1737      1.1737      2.4064      3.5143      3.5143           0      1.1522      1.1522       3.903       3.903           5      4.0298      4.0298           5     0.59567     0.59567     0.12406           0      3.0159      3.0159       2.742      2.6998      2.6998           5      1.7318      1.7318      1.7447      4.0399      4.0399           5      2.8811      2.8811           5      4.2722      4.2722      3.4045      1.1728      1.1728           0      1.9225      1.9225      2.6202      3.5058      3.5058           5      3.6663      3.6663           5      3.7018      3.7018           5      2.6774      2.6774      2.7475       3.011       3.011      2.8157      2.7854      2.7854           0      2.0322      2.0322      1.8315      1.5724      1.5724      1.3483       1.298       1.298      4.5476      4.5476      3.4881      3.4881      1.5376      1.5376           0      1.5244      1.5244      1.1737           0     0.36042     0.36042           0      2.9127      2.9127           5      3.7342      3.7342           5      1.5241      1.5241           0     0.57547     0.57547           0      2.5767      3.0236      3.0236      2.8601     0.39912     0.39912           5      4.8011      4.8011      4.8955      4.9079      4.9079      3.7144    0.069875    0.069875           0      0.4458     0.46578     0.46578     0.55989      2.0959      2.0959           0     0.04012     0.04012           0      3.6469      3.6469           0      1.4171      1.4171       4.475       4.475      3.4442      3.0233      3.0233      4.8341      4.8341      3.1201      2.4597      2.4597           0      2.0282      2.0282      3.1663      4.1627      4.1627];
 
elseif (blockages == 8)
    x1 = [1.0783           0      1.5547      1.5547           0      1.4301      1.4301           0      1.6405      1.6405      4.7828           5      3.6841      3.6841           5      4.3843      4.3843      2.5637      2.5637           5      4.4149      4.4149           5      3.3211      3.2068      3.2068      3.2062      3.1683      3.1683      2.1828      2.1263      2.1263      2.2508      3.9078      3.9078      4.3925      4.3925           5      1.6437      1.6437           5      3.0538      3.0538      2.2282      1.3832      1.3832      0.1809      0.1809           0      2.6879      2.6879     0.20304     0.20304       0.597      1.1982      1.1982];
    y1 =  [0.73342      1.7776      3.2831      3.2831      2.9286      2.6026      2.6026      1.9977      1.3039      1.3039           0     0.09013     0.63615     0.63615      1.7315       2.244       2.244      3.9003      3.9003      4.2947      4.3895      4.3895      4.5473           5      4.9692      4.9692           5      2.9931      2.9931           5       4.885       4.885           5      3.4692      3.4692     0.18919     0.18919     0.44624      1.8665      1.8665      1.3265      1.0134      1.0134           0      1.0371      1.0371      3.5071      3.5071      3.4525      2.6405      2.6405      1.9362      1.9362           0      2.9549      2.9549];
 
    x2 = [2.0829      3.7486           5      4.8504      4.8504      3.0874      1.6313      1.6313           0       0.329      2.2286      2.2286      2.7039      3.3048      3.3048      3.3002      3.3002           5      2.9419      2.9419      4.7608      4.7608           5      2.5717      2.5717      2.5966      2.8319      2.8319           0     0.30787     0.30787     0.38606      1.0395      1.0395      1.1239      1.8247      1.8247           0     0.83228     0.83228      1.0934      1.6053      1.6053      2.2637      2.7141      2.7141      4.5444           5      4.2538      4.2538           0      1.5566      1.5566      2.1627      2.1627      1.1897      1.1897];
    y2 = [3.0984           5      3.5714      3.4006      3.4006           5      3.6791      3.6791      4.7783           5      3.7201      3.7201           5      3.3817      3.3817      0.7337      0.7337      1.0201      1.3669      1.3669      3.0398      3.0398      2.7891     0.24362     0.24362           0      2.3077      2.3077      4.2431      4.4536      4.4536           5     0.43346     0.43346           0      3.5986      3.5986      3.5696      3.5563      3.5563           5      2.1704      2.1704           0      1.4845      1.4845           0     0.36952     0.97471     0.97471     0.85752     0.81464     0.81464      3.2071      3.2071     0.45093     0.45093];
 
end

p = [1.25 3.75 3.75 1.25]; q = [1.25 1.25 3.75 3.75]; %Location of LED
PD_x = 2.5; PD_y = 2.5;
r = 0.4; %Blockage radius

% led_ind = 1;

for led_ind = 1:length(p)

m = (PD_y-q(led_ind))/(PD_x-p(led_ind));    
c = -p(led_ind)*(PD_y-q(led_ind))/(PD_x-p(led_ind)) + q(led_ind);

if (p(led_ind) == 1.25 && q(led_ind) == 1.25) || (p(led_ind) == 3.75 && q(led_ind) == 1.25)
     d = sqrt((PD_x-p(led_ind))^2 + (PD_y - q(led_ind))^2) * sqrt(1+ (-1/m)^2);
elseif (p(led_ind) == 3.75 && q(led_ind) == 3.75) || (p(led_ind) == 1.25 && q(led_ind) == 3.75)
     d = -sqrt((PD_x-p(led_ind))^2 + (PD_y - q(led_ind))^2) * sqrt(1+ (-1/m)^2);
end

%CD: y = mx+c1
c1 = r/2 * sqrt(1+m^2) + c;
CD = y == m*x + c1;
CD_m = m;
CD_c = c1;

%AB: y = mx+c2
c2 = -r/2 * sqrt(1+m^2) + c;
AB = y == m*x + c2;
AB_m = m;
AB_c = c2;


%Line of minimum of distance (AD)
AD = y == -1/m*x + (24*PD_y)/43 + (19*q(led_ind))/43 ...
    + ((PD_x-p(led_ind))*(24*PD_x/43 + 19*p(led_ind)/43))/(PD_y-q(led_ind));
AD_m = -1/m;
AD_c = 24*PD_y/43 + 19*q(led_ind)/43 + ((PD_x-p(led_ind))*((24*PD_x)/43 + 19*p(led_ind)/43))/(PD_y-q(led_ind));

%Point D
[Dx, Dy] = solve([CD, AD], [x,y]);

%Point A
[Ax, Ay] = solve([AD, AB], [x,y]);

Axc = x == Ax;

%Point F
[Fx, Fy] = solve([CD, Axc],[x, y]);

Dxc = x == Dx;

%Point H (for LED = (3.75,3.75) and (1.25, 3.75))
[Hx, Hy] = solve([AB, Dxc], [x,y]);

%Line EG (variable line)
EG = y == -1/m * x + p(led_ind)/m + q(led_ind) + d;
EG_m = -1/m;
EG_c = p(led_ind)/m + q(led_ind) + d;

%Point E
[Ex, Ey] = solve([CD, EG],[x, y]);

%Point G
[Gx, Gy] = solve([AB, EG], [x,y]);

%1. LED (1.25, 1.25) __________________________________
if (p(led_ind) == 1.25 && q(led_ind) == 1.25)
    xv_A = [double(Ax) double(Gx) double(Ex) double(Dx) double(Ax)]; %x shadow rectangle
    yv_A = [double(Ay) double(Gy) double(Ey) double(Dy) double(Ay)]; %y shadow rectangle
%     in_shadow_A1 = inpolygon(x1,y1,xv_A,yv_A);
%     in_shadow_A2 = inpolygon(x2,y2,xv_A,yv_A);
    
%2. LED (3.75, 1.25) __________________________________
elseif (p(led_ind) == 3.75 && q(led_ind) == 1.25)
    xv_B = [double(Ax) double(Gx) double(Ex) double(Dx) double(Ax)]; %x shadow rectangle
    yv_B = [double(Ay) double(Gy) double(Ey) double(Dy) double(Ay)]; %y shadow rectangle
%     in_shadow_B1 = inpolygon(x1,y1,xv_B,yv_B);
%     in_shadow_B2 = inpolygon(x2,y2,xv_B,yv_B);
    
%3. LED (3.75, 3.75)__________________________________    
elseif (p(led_ind) == 3.75 && q(led_ind) == 3.75)    
    xv_C = [double(Ax) double(Gx) double(Ex) double(Dx) double(Ax)]; %x shadow rectangle
    yv_C = [double(Ay) double(Gy) double(Ey) double(Dy) double(Ay)]; %y shadow rectangle
%     in_shadow_C1 = inpolygon(x1,y1,xv_C,yv_C);
%     in_shadow_C2 = inpolygon(x2,y2,xv_C,yv_C);

%4. LED (1.25, 3.75)__________________________________
elseif (p(led_ind) == 1.25 && q(led_ind) == 3.75)
    xv_D = [double(Ax) double(Gx) double(Ex) double(Dx) double(Ax)]; %x shadow rectangle
    yv_D = [double(Ay) double(Gy) double(Ey) double(Dy) double(Ay)]; %y shadow rectangle
%     in_shadow_D1 = inpolygon(x1,y1,xv_D,yv_D);
%     in_shadow_D2 = inpolygon(x2,y2,xv_D,yv_D);
end
    

end

figure(1);
if(blockages == 1)
    plot(x1, y1,'bo','linewidth',1.5);
elseif(blockages == 2)
    plot(x1, y1,'bo','linewidth',1.5);
    hold on;
    plot(x2, y2,'ro','linewidth',1.5);
elseif(blockages == 3)
    plot(x1, y1,'bo','linewidth',1.5);
    hold on;
    plot(x2, y2,'ro','linewidth',1.5);
    plot(x3,y3, 'mo','linewidth',1.5);
elseif(blockages == 4)
    plot(x1, y1,'bo','linewidth',1.5);
    hold on;
    plot(x2, y2,'ro','linewidth',1.5);
    plot(x3,y3, 'mo','linewidth',1.5);
    plot(x4,y4, 'ko','linewidth',1.5);
elseif(blockages == 5)    
    plot(x1, y1,'bo','linewidth',1.5);
    hold on;
    plot(x2, y2,'ro','linewidth',1.5);
    plot(x3,y3, 'mo','linewidth',1.5);
    plot(x4,y4, 'ko','linewidth',1.5);
    plot(x5,y5, 'd', 'linewidth', 1.5);
elseif(blockages == 6)
    plot(x1, y1,'bo','linewidth',1.5);
    hold on;
    plot(x2, y2,'ro','linewidth',1.5); 
elseif(blockages == 7)
    plot(x1, y1,'bo','linewidth',1.5);
    hold on;
    plot(x2, y2,'ro','linewidth',1.5); 
elseif(blockages == 8)
    plot(x1, y1,'bo','linewidth',1.5);
    hold on;
    plot(x2, y2,'ro','linewidth',1.5); 
end
hold on;
figure(1);
% plot(x2,y2,'o','linewidth',1.5);
% hold on;
plot([1.25 PD_x], [1.25 PD_y], 'g', 'linewidth', 1.5);
plot([1.25 PD_x], [3.75 PD_y], 'g', 'linewidth', 1.5);
plot([3.75 PD_x], [1.25 PD_y], 'g', 'linewidth', 1.5);
plot([3.75 PD_x], [3.75 PD_y], 'g', 'linewidth', 1.5);

% plot(x1(in_shadow_A1),y1(in_shadow_A1),'bo', 'linewidth', 1) % points inside shadow A
% plot(x1(in_shadow_B1),y2(in_shadow_B1),'b*', 'linewidth', 1) % points inside shadow B
% plot(x1(in_shadow_C1),y1(in_shadow_C1),'b+', 'linewidth', 1) % points inside shadow C
% plot(x1(in_shadow_D1),y2(in_shadow_D1),'bx', 'linewidth', 1) % points inside shadow D
% 
% plot(x1(in_shadow_A2),y1(in_shadow_A2),'ro', 'linewidth', 1) % points inside shadow A
% plot(x1(in_shadow_B2),y2(in_shadow_B2),'r*', 'linewidth', 1) % points inside shadow B
% plot(x1(in_shadow_C2),y1(in_shadow_C2),'r+', 'linewidth', 1) % points inside shadow C
% plot(x1(in_shadow_D2),y2(in_shadow_D2),'rx', 'linewidth', 1) % points inside shadow D

plot(xv_A,yv_A,'--', 'linewidth', 1.5); plot(xv_B,yv_B,'--', 'linewidth', 1.5); 
plot(xv_C,yv_C,'--', 'linewidth', 1.5); plot(xv_D,yv_D,'--', 'linewidth', 1.5);


hold off;
%legend('Pause locations B1', 'Pause locations B2', 'Pause locations B3', ...
%    'Pause locations B4', 'Pause locations B5','location', 'bestoutside');
title('Path of blockages inside a 5x5x3 m room');